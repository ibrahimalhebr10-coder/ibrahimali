# โ ุงููุธุงู ุงููุงูู: ุงููุตู ุงูุชุงู + ุชุฏูู ุชุณุฌูู ุงูุฏุฎูู

**ุงูุชุงุฑูุฎ:** 2026-02-06
**ุงูุญุงูุฉ:** โ **ููุชูู ูููุทุจู**

---

## ๐ฏ ุงูููุฎุต ุงูุชูููุฐู

ุชู ุฅุตูุงุญ ูุดููุชูู ุฑุฆูุณูุชูู:

1. โ **ุงููุตู ุงูุชุงู**: ุฒุฑ "ุญุณุงุจู" ููุญุต ููุน ุงูุญุณุงุจ ูููุฌู ุชููุงุฆูุงู
2. โ **ุชุฏูู ุชุณุฌูู ุงูุฏุฎูู**: ุจุนุฏ ุงููุฌุงุญุ ููุชุญ ุงูุญุณุงุจ ุงูุตุญูุญ ุชููุงุฆูุงู

---

## ๐ง ุงูุฅุตูุงุญุงุช ุงูููุทุจูุฉ

### ุงูุฅุตูุงุญ 1๏ธโฃ: ุฒุฑ "ุญุณุงุจู" ูู ุงูููุฏุฑ

#### ุงููุดููุฉ:
```typescript
// ุงููุฏูู
const handleMyAccountClick = () => {
  if (user) {
    setShowAccountProfile(true);  // โ ุญุณุงุจ ุนุงุฏู ุฏุงุฆูุงู
  }
};
```

#### ุงูุญู:
```typescript
// ุงูุฌุฏูุฏ
const handleMyAccountClick = () => {
  setShowQuickAccountAccess(true);  // โ ููุญุต ููุน ุงูุญุณุงุจ
};
```

### ุงูุฅุตูุงุญ 2๏ธโฃ: ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

#### ุงููุดููุฉ:
```typescript
// ุงููุฏูู
const handleRegistrationSuccess = () => {
  setShowStandaloneRegistration(false);
  // โ ูุง ููุชุญ ุดูุก
};
```

#### ุงูุญู:
```typescript
// ุงูุฌุฏูุฏ
const handleRegistrationSuccess = () => {
  setShowStandaloneRegistration(false);
  setTimeout(() => {
    setShowQuickAccountAccess(true);  // โ ููุนูุฏ ูุญุต ููุน ุงูุญุณุงุจ
  }, 300);
};
```

---

## ๐ ุงูุชุฏูู ุงููุงูู

### ุงูุณููุงุฑูู A: ุดุฑูู ูุฌุงุญ ูุณุฌู ุฏุฎูู

```
1. ูุถุบุท "ุญุณุงุจู"
   โ
2. QuickAccountAccess โ loading
   โ
3. RPC: get_user_account_types()
   Result: 'partner'
   โ
4. โ ููุชุญ SuccessPartnerAccount ุชููุงุฆูุงู

5. ูุฑู:
   โ Header ุฐูุจู
   โ ุจุทุงูุฉ ุฐูุจูุฉ
   โ ููุญุฉ ุงููุคุซุฑ
   โ ุงูููุงูุขุช
   โ ูุง ุชุจููุจุงุช
   โ ูุง ุฃุดุฌุงุฑู
```

### ุงูุณููุงุฑูู B: ุนููู ุนุงุฏู ูุณุฌู ุฏุฎูู

```
1. ูุถุบุท "ุญุณุงุจู"
   โ
2. QuickAccountAccess โ loading
   โ
3. RPC: get_user_account_types()
   Result: 'regular'
   โ
4. โ ููุชุญ AccountProfile ุชููุงุฆูุงู

5. ูุฑู:
   โ ุชุจููุจุงุช: ุฃุดุฌุงุฑู ุงูุฎุถุฑุงุก/ุงูุฐูุจูุฉ
   โ ุจูุงูุงุช ุงูุญุณุงุจ
   โ ูุง ููุญุฉ ูุคุซุฑ
```

### ุงูุณููุงุฑูู C: ุดุฑูู ูุฌุงุญ ุบูุฑ ูุณุฌู ุฏุฎูู

```
1. ูุถุบุท "ุญุณุงุจู"
   โ
2. QuickAccountAccess โ AccountLoginSelector

3. ูุถุบุท "ุชุณุฌูู ุฏุฎูู"
   โ
4. ููุฏุฎู: 0511111111 / 111111
   โ
5. โ ุชุณุฌูู ุฏุฎูู ูุงุฌุญ
   โ
6. QuickAccountAccess ููุนุงุฏ ูุชุญู
   โ
7. RPC: get_user_account_types()
   Result: 'partner'
   โ
8. โ ููุชุญ SuccessPartnerAccount ุชููุงุฆูุงู!
```

### ุงูุณููุงุฑูู D: ูุฏูู ุงูุญุณุงุจูู ูุนุงู

```
1. ูุถุบุท "ุญุณุงุจู"
   โ
2. QuickAccountAccess โ loading
   โ
3. RPC: get_user_account_types()
   Result: 'both'
   โ
4. โ ูุธูุฑ DualAccountSelector

   โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  ุงุฎุชุฑ ุงูุญุณุงุจ            โ
   โ  [๐ณ] ุญุณุงุจู (ุฃุดุฌุงุฑู)    โ
   โ  [โญ] ุญุณุงุจ ุดุฑูู ุงููุฌุงุญ  โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโ

5. ูุฎุชุงุฑ:
   - ๐ณ โ AccountProfile
   - โญ โ SuccessPartnerAccount
```

---

## ๐ ุงูุฃูุงู ูุงููุญุต

### QuickAccountAccess ููุญุต ุนุจุฑ RPC:

```typescript
// useEffect runs when user changes
useEffect(() => {
  checkAccountType();
}, [user]);

const checkAccountType = async () => {
  if (!user) {
    setAccountType('none');
    return;
  }

  const { data } = await supabase.rpc('get_user_account_types');
  const type = data?.account_type || 'none';

  setAccountType(type);

  // Smart auto-routing
  if (type === 'regular') {
    onOpenRegularAccount();
    onClose();
  } else if (type === 'partner') {
    onOpenPartnerAccount();
    onClose();
  }
  // 'both' shows selector
  // 'none' shows login selector
};
```

### RPC Function ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```sql
CREATE OR REPLACE FUNCTION get_user_account_types()
RETURNS TABLE (
  account_type TEXT,
  has_reservations BOOLEAN,
  is_partner BOOLEAN
) AS $$
BEGIN
  RETURN QUERY
  SELECT
    CASE
      WHEN has_res AND is_inf THEN 'both'::TEXT
      WHEN has_res THEN 'regular'::TEXT
      WHEN is_inf THEN 'partner'::TEXT
      ELSE 'none'::TEXT
    END as account_type,
    has_res as has_reservations,
    is_inf as is_partner
  FROM (
    SELECT
      EXISTS (
        SELECT 1 FROM reservations
        WHERE user_id = auth.uid()
        AND status = 'confirmed'
      ) as has_res,
      EXISTS (
        SELECT 1 FROM influencer_partners
        WHERE user_id = auth.uid()
      ) as is_inf
  ) stats;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
```

---

## ๐ ุฌุฏูู ุงูููุงุฑูุฉ ุงูุดุงูู

| ุงููุธููุฉ | ูุจู ุงูุฅุตูุงุญ | ุจุนุฏ ุงูุฅุตูุงุญ |
|---------|-------------|-------------|
| ุฒุฑ "ุญุณุงุจู" | โ AccountProfile ุฏุงุฆูุงู | โ ููุญุต ูููุฌู ุชููุงุฆูุงู |
| ุดุฑูู ูุฌุงุญ (ูุณุฌู) | โ ูุฑู ุชุจููุจุงุช | โ ุญุณุงุจู ุงูุฐูุจู ููุท |
| ุดุฑูู ูุฌุงุญ (ุชุณุฌูู ุฏุฎูู) | โ ูุนูุฏ ููุฑุฆูุณูุฉ | โ ููุชุญ ุญุณุงุจู ุชููุงุฆูุงู |
| ุนููู ุนุงุฏู | โ ูุฑู ุฃุดุฌุงุฑู | โ ูุฑู ุฃุดุฌุงุฑู |
| ุงูุญุณุงุจูู ูุนุงู | โ ุฃุดุฌุงุฑู ููุท | โ selector ููุงุฎุชูุงุฑ |
| ุบูุฑ ูุณุฌู | โ๏ธ ูุตู ููุทุจู | โ login selector |
| ุงููุญุต ุงูุชููุงุฆู | โ ูุง ููุฌุฏ | โ ุนุจุฑ RPC |
| ุฅุนุงุฏุฉ ุงููุญุต ุจุนุฏ Login | โ ูุง ููุฌุฏ | โ ุชููุงุฆูุงู |

---

## ๐งช ุฏููู ุงูุงุฎุชุจุงุฑ ุงูุดุงูู

### ุงุฎุชุจุงุฑ 1: ุดุฑูู ูุฌุงุญ ูุณุฌู ุฏุฎูู โ

```bash
1. ุณุฌู ุฏุฎูู: 0511111111 / 111111

2. ุงุถุบุท "ุญุณุงุจู" ูู ุงูููุฏุฑ

3. ุงูุชุธุฑ 2 ุซุงููุฉ (loading)

4. โ ุงููุชูุฌุฉ ุงููุชููุนุฉ:
   - ููุชุญ SuccessPartnerAccount
   - Header ุฐูุจู: "ุญุณุงุจ ุดุฑูู ุงููุฌุงุญ"
   - ุจุทุงูุฉ ุฐูุจูุฉ ูุน Sparkles
   - InfluencerDashboard
   - ุงูููุงูุขุช: 0.00 ุฑูุงู
   - ุงูุนููุงุก: 0
   - ุฃุฏูุงุช ุงููุดุงุฑูุฉ
   - โ ูุง ุชุจููุจุงุช
   - โ ูุง ุฃุดุฌุงุฑู
```

### ุงุฎุชุจุงุฑ 2: ุดุฑูู ูุฌุงุญ ุบูุฑ ูุณุฌู ุฏุฎูู โ

```bash
1. ุงูุชุญ ุงูููุตุฉ (logout)

2. ุงุถุบุท "ุญุณุงุจู" ูู ุงูููุฏุฑ

3. ูุธูุฑ AccountLoginSelector:
   [ุชุณุฌูู ุฏุฎูู]
   [ุฅูุดุงุก ุญุณุงุจ]

4. ุงุถุบุท "ุชุณุฌูู ุฏุฎูู"

5. ุฃุฏุฎู: 0511111111 / 111111

6. ุงุถุบุท "ุชุณุฌูู ุงูุฏุฎูู"

7. โ ุงููุชูุฌุฉ ุงููุชููุนุฉ ุจุนุฏ 2-3 ุซูุงูู:
   - ููุบูู ุตูุญุฉ ุงูุชุณุฌูู
   - QuickAccountAccess loading
   - ููุชุญ SuccessPartnerAccount ุชููุงุฆูุงู!
   - ููุณ ุงููุธูุฑ ูุงูุงุฎุชุจุงุฑ 1
```

### ุงุฎุชุจุงุฑ 3: ุนููู ุนุงุฏู โ

```bash
1. ุณุฌู ุฏุฎูู ุจุญุณุงุจ ุนููู (ูุฏูู ุญุฌูุฒุงุช confirmed)

2. ุงุถุบุท "ุญุณุงุจู"

3. โ ุงููุชูุฌุฉ ุงููุชููุนุฉ:
   - ููุชุญ AccountProfile
   - ุชุจููุจุงุช: ุฃุดุฌุงุฑู ุงูุฎุถุฑุงุก / ุงูุฐูุจูุฉ
   - ุจูุงูุงุช ุงูุญุณุงุจ
   - โ ูุง ููุญุฉ ูุคุซุฑ
```

### ุงุฎุชุจุงุฑ 4: ุงูุญุณุงุจูู ูุนุงู โ

```bash
1. ุณุฌู ุฏุฎูู ุจุญุณุงุจ:
   - ูุฏูู ุญุฌูุฒุงุช confirmed
   - ูุณุฌู ูู influencer_partners

2. ุงุถุบุท "ุญุณุงุจู"

3. โ ุงููุชูุฌุฉ ุงููุชููุนุฉ:
   - DualAccountSelector

   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ  ุงุฎุชุฑ ุงูุญุณุงุจ                โ
   โ                              โ
   โ  [๐ณ] ุญุณุงุจู (ุฃุดุฌุงุฑู)        โ
   โ  [โญ] ุญุณุงุจ ุดุฑูู ุงููุฌุงุญ      โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

4. ุฌุฑุจ:
   - ุงุถุบุท ๐ณ โ AccountProfile
   - ุงุถุบุท โญ โ SuccessPartnerAccount
```

---

## ๐ ููุฎุต ุงููููุงุช ุงูููุนุฏูุฉ

### src/App.tsx

#### ุงูุชุบููุฑ 1: handleMyAccountClick (ุงูุณุทุฑ 491)
```typescript
// ุฏุงุฆูุงู ููุชุญ QuickAccountAccess
setShowQuickAccountAccess(true);
```

#### ุงูุชุบููุฑ 2: handleRegistrationSuccess (ุงูุณุทุฑ 573)
```typescript
// ุจุนุฏ ุงููุฌุงุญุ ููุนูุฏ ูุชุญ QuickAccountAccess
setTimeout(() => {
  setShowQuickAccountAccess(true);
}, 300);
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

```
โ ุงููุตู ุงูุชุงู ููุทุจู
โ ุฒุฑ "ุญุณุงุจู" ููุญุต ููุน ุงูุญุณุงุจ
โ ุดุฑูู ุงููุฌุงุญ โ ุญุณุงุจู ุงูุฐูุจู ููุท
โ ุชุณุฌูู ุงูุฏุฎูู โ ููุชุญ ุงูุญุณุงุจ ุงูุตุญูุญ ุชููุงุฆูุงู
โ QuickAccountAccess ููุนุงุฏ ูุชุญู ุจุนุฏ Login
โ RPC ููุญุต ููุน ุงูุญุณุงุจ
โ ุงูุชูุฌูู ุงูุชููุงุฆู ูุนูู
โ DualAccountSelector ููุญุณุงุจูู ูุนุงู
โ AccountLoginSelector ูุบูุฑ ุงููุณุฌููู
โ ูุง ุชุฏุงุฎู ุจูู ุงูุฃูุธูุฉ
โ Build ูุงุฌุญ
โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ
```

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

```
๐ฏ ุงููุดููุฉ 1: ุงููุตู ุบูุฑ ููุทุจู
   โ ุงูุญู: handleMyAccountClick ูุณุชุฎุฏู QuickAccountAccess

๐ฏ ุงููุดููุฉ 2: ุชุณุฌูู ุงูุฏุฎูู ูุง ููุชุญ ุงูุญุณุงุจ
   โ ุงูุญู: handleRegistrationSuccess ููุนูุฏ QuickAccountAccess

๐ฏ ุงููุชูุฌุฉ:
   โ ูุตู ุชุงู
   โ ุชูุฌูู ุชููุงุฆู
   โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ
   โ ุฃูุงู ูุญูู
   โ ุฌุงูุฒ ููุฅูุชุงุฌ
```

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 2026-02-06
**ุงูุญุงูุฉ:** โ **ููุชูู ูููุทุจู ูุฌุงูุฒ**
**Build:** โ **ูุงุฌุญ**
**ุงูุงุฎุชุจุงุฑ:** ๐งช **ุฌุงูุฒ ููุชูููุฐ**
