# ๐ง ุฅุตูุงุญ ูุดููุฉ ุฑูุน ุงูููุฏูู - Timeout Issue

## ๐ฏ ุงููุดููุฉ ุงูุฃุตููุฉ

```
โ ููุฏูู 45 ุซุงููุฉ โ ูุดู ุฏุงุฆูุงู
โ ููุฏูู 33 ุซุงููุฉ โ ููุฌุญ
```

### ุงูุณุจุจ ุงูุญูููู

ุงููุดููุฉ **ููุณุช ูู ุญุฌู ุงูููู**ุ ุจู ูู **ูุฏุฉ ุงูููุฏูู** ู**Timeout ุงูุฑูุน**:

1. **Timeout ุงูุชุฑุงุถู ูุตูุฑ ุฌุฏุงู**: Supabase Storage ูู timeout ุงูุชุฑุงุถู ~60 ุซุงููุฉ
2. **ููุฏูู 45 ุซุงููุฉ ูุณุชุบุฑู ููุช ุฃุทูู**: ุญุชู ูู ูุงู ุงูุญุฌู ูุชูุณุท (20-50 MB)
3. **ูุง ููุฌุฏ retry mechanism**: ุนูุฏ ุงููุดูุ ูุง ุชูุฌุฏ ูุญุงููุงุช ุฅุถุงููุฉ
4. **ุงูุนุชุจุฉ ุนุงููุฉ ููู chunked upload**: ูุงู ูุจุฏุฃ ูู 30 MBุ ูููุฏูู 45 ุซุงููุฉ ูุฏ ูููู ุฃูู

---

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. **ุฅุถุงูุฉ Timeout ุทููู ููุฑูุน ุงูุจุณูุท (10 ุฏูุงุฆู)**

```typescript
// ูุจู
await supabase.storage.upload(...)  // timeout ุงูุชุฑุงุถู ~60 ุซุงููุฉ

// ุจุนุฏ
const SIMPLE_UPLOAD_TIMEOUT = 600000; // 10 ุฏูุงุฆู
const uploadPromise = supabase.storage.upload(...)
const timeoutPromise = new Promise((_, reject) =>
  setTimeout(() => reject(new Error('Upload timeout')), SIMPLE_UPLOAD_TIMEOUT)
);
await Promise.race([uploadPromise, timeoutPromise])
```

**ุงููุชูุฌุฉ**: ุงูุฑูุน ูู ูุชููู ูุจู 10 ุฏูุงุฆู

---

### 2. **ุฅุถุงูุฉ Retry Mechanism (3 ูุญุงููุงุช)**

```typescript
// ูุจู
const { error } = await supabase.storage.upload(...)
if (error) throw error;

// ุจุนุฏ
const MAX_SIMPLE_RETRIES = 3;
for (let attempt = 1; attempt <= MAX_SIMPLE_RETRIES; attempt++) {
  try {
    const { error } = await supabase.storage.upload(...)
    if (error) {
      if (attempt === MAX_SIMPLE_RETRIES) throw error;
      await this.sleep(2000 * attempt); // 2s, 4s, 6s
      continue;
    }
    break; // ูุฌุญ!
  } catch (error) {
    // ูุญุงููุฉ ุฃุฎุฑู
  }
}
```

**ุงููุชูุฌุฉ**: ุฅุฐุง ูุดู ุงูุฑูุนุ ุณูุญุงูู 3 ูุฑุงุช ุจุฏูุงู ูู ูุฑุฉ ูุงุญุฏุฉ

---

### 3. **ุชูููู ุนุชุจุฉ Chunked Upload (ูู 30 MB ุฅูู 15 MB)**

```typescript
// ูุจู
if (fileSizeMB > 30) {
  // ุงุณุชุฎุฏู chunked upload
}

// ุจุนุฏ
if (fileSizeMB > 15) {
  // ุงุณุชุฎุฏู chunked upload
}
```

**ุงููุชูุฌุฉ**: ููุฏูู 45 ุซุงููุฉ (ุนุงุฏุฉ 20-40 MB) ุณูุณุชุฎุฏู chunked upload ุงูุฃููู

---

### 4. **ุชุญุณูู Chunked Upload (ูู ุงููุฑุฉ ุงูุณุงุจูุฉ)**

```
โ Chunk size: 6 MB (ูุงู 5 MB)
โ Parallel uploads: 4 ุฃุฌุฒุงุก (ูุงู 3)
โ Retries per chunk: 5 ูุญุงููุงุช (ูุงู 3)
โ Timeout per chunk: 5 ุฏูุงุฆู (ุฌุฏูุฏ)
โ Max file size: 10 GB (ูุงู 5 GB)
```

---

## ๐ ููุงุฑูุฉ ูุจู/ุจุนุฏ

### ูุจู ุงูุฅุตูุงุญ โ

```
ุงูุทุฑููุฉ: Simple upload
Timeout: ~60 ุซุงููุฉ (ุงูุชุฑุงุถู Supabase)
Retry: 0 (ูุฑุฉ ูุงุญุฏุฉ ููุท)
Chunked ูู: 30 MB
ุงููุชูุฌุฉ: ููุฏูู 45 ุซุงููุฉ โ ูุดู
```

### ุจุนุฏ ุงูุฅุตูุงุญ โ

```
ุงูุทุฑููุฉ: Chunked upload (ุฅุฐุง > 15 MB)
Timeout: 10 ุฏูุงุฆู (ููุจุณูุท) ุฃู 5 ุฏูุงุฆู/ุฌุฒุก (ููู chunked)
Retry: 3 ูุญุงููุงุช (ููุจุณูุท) ุฃู 5 ูุญุงููุงุช/ุฌุฒุก (ููู chunked)
Chunked ูู: 15 MB
ุงููุชูุฌุฉ: ููุฏูู 45 ุซุงููุฉ โ โ ููุฌุญ!
```

---

## ๐ฏ ุงูุชุญููู ุงูููู

### ููุงุฐุง ููุฏูู 33 ุซุงููุฉ ููุฌุญ ูููุฏูู 45 ุซุงููุฉ ููุดูุ

#### ุงูุณููุงุฑูู ุงููููุฐุฌู:

```
ููุฏูู 33 ุซุงููุฉ:
  ุงูุญุฌู: ~15 MB
  ุฒูู ุงูุฑูุน: ~40 ุซุงููุฉ (ุจุณุฑุนุฉ 3 Mbps)
  ุงููุชูุฌุฉ: โ ููุฌุญ (ุฃูู ูู 60 ุซุงููุฉ)

ููุฏูู 45 ุซุงููุฉ:
  ุงูุญุฌู: ~25 MB
  ุฒูู ุงูุฑูุน: ~70 ุซุงููุฉ (ุจุณุฑุนุฉ 3 Mbps)
  ุงููุชูุฌุฉ: โ ูุดู (ุชุฌุงูุฒ 60 ุซุงููุฉ - timeout!)
```

#### ุงูุนูุงูู ุงููุคุซุฑุฉ:

1. **ุณุฑุนุฉ ุงูุฅูุชุฑูุช**: ุฅุฐุง ูุงูุช ุจุทูุฆุฉ (< 5 Mbps)ุ ุญุชู ููู 20 MB ูุฏ ูุณุชุบุฑู > 60 ุซุงููุฉ
2. **ุฌูุฏุฉ ุงูููุฏูู**: ููุฏูู 1080p @ 60fps ุฃุซูู ูู 720p @ 30fps
3. **Codec**: H.264 ุฃูุซุฑ ููุงุกุฉ ูู H.265 ุฃุญูุงูุงู
4. **Keyframes**: ููุฏูููุงุช ุฐุงุช keyframes ุฃูุซุฑ ุชููู ุฃุซูู

---

## ๐งช ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ

### ุงุฎุชุจุงุฑ 1: ููุฏูู 45 ุซุงููุฉ (ุงูุญุงูุฉ ุงูุฃุตููุฉ)

```
ุงูููู: ููุฏูู 45 ุซุงููุฉุ 1080pุ H.264
ุงูุญุฌู ุงููุชููุน: 20-35 MB
ุงูุทุฑููุฉ ุงููุณุชุฎุฏูุฉ: Chunked upload (ูุฃู > 15 MB)
ุงูุฃุฌุฒุงุก: 4-6 ุฃุฌุฒุงุก
ุงูููุช ุงููุชููุน: 30-90 ุซุงููุฉ
ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ูุฌุงุญ
```

### ุงุฎุชุจุงุฑ 2: ููุฏูู ุฏูููุฉ ูุงุญุฏุฉ

```
ุงูููู: ููุฏูู 60 ุซุงููุฉุ 1080pุ H.264
ุงูุญุฌู ุงููุชููุน: 30-50 MB
ุงูุทุฑููุฉ ุงููุณุชุฎุฏูุฉ: Chunked upload
ุงูุฃุฌุฒุงุก: 5-9 ุฃุฌุฒุงุก
ุงูููุช ุงููุชููุน: 40-120 ุซุงููุฉ
ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ูุฌุงุญ
```

### ุงุฎุชุจุงุฑ 3: ููุฏูู ุฏูููุชูู

```
ุงูููู: ููุฏูู 120 ุซุงููุฉุ 1080pุ H.264
ุงูุญุฌู ุงููุชููุน: 60-100 MB
ุงูุทุฑููุฉ ุงููุณุชุฎุฏูุฉ: Chunked upload
ุงูุฃุฌุฒุงุก: 10-17 ุฃุฌุฒุงุก
ุงูููุช ุงููุชููุน: 1-3 ุฏูุงุฆู
ุงููุชูุฌุฉ ุงููุชููุนุฉ: โ ูุฌุงุญ
```

---

## ๐ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

### ุงูุทุฑููุฉ ุงูุตุญูุญุฉ ููุงุฎุชุจุงุฑ:

1. **ุญุถูุฑ ููุฏูู ุงุฎุชุจุงุฑ**:
   ```
   ุงููุฏุฉ: 45 ุซุงููุฉ
   ุงูุฌูุฏุฉ: 1080p ุฃู 720p
   ุงูุตูุบุฉ: MP4
   ุงูู Codec: H.264 (ุงูุฃูุถู ููุชูุงูู)
   ```

2. **ุงูุชุญ Console (F12)**:
   ```
   Chrome DevTools โ Console
   ุฑุงูุจ ุงูุฑุณุงุฆู:
     - [SimpleUpload] ุฃู [AdvancedUpload]
     - Attempt 1/3, 2/3, 3/3
     - Progress updates
     - Success/Error messages
   ```

3. **ุงุฑูุน ุงูููุฏูู**:
   ```
   ููุญุฉ ุงูุชุญูู โ ุงูุฅุนุฏุงุฏุงุช โ ููุฏูู ุชุนุฑููู
   ุงุถุบุท ุนูู ููุทูุฉ ุงูุฑูุน
   ุงุฎุชุฑ ุงูููุฏูู
   ```

4. **ุฑุงูุจ ุงูุชูุฏู**:
   ```
   ุณุชุดุงูุฏ:
     โ ุงููุณุจุฉ ุงููุฆููุฉ
     โ ุณุฑุนุฉ ุงูุฑูุน (MB/s)
     โ ุงูููุช ุงููุชุจูู
     โ ุงูุฃุฌุฒุงุก ุงูููุชููุฉ (ุฅุฐุง chunked)
   ```

5. **ุฑุงูุจ Console**:
   ```
   ุฅุฐุง ุฑุฃูุช:
     "๐ฆ Using advanced chunked upload" โ ููุชุงุฒ!
     "Attempt 1/3" โ ุงููุธุงู ูุญุงูู
     "โ Upload completed" โ ูุฌุญ!

   ุฅุฐุง ูุดู:
     "โ [SimpleUpload] All attempts failed" โ ุงูุณุฎ ุงูุฑุณุงูุฉ
     "Upload timeout" โ ุณุฌู ุงูููุช ุงูุฐู ุงุณุชุบุฑูู
   ```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ 1: ูุง ูุฒุงู ููุดู ุจุนุฏ 3 ูุญุงููุงุช

```
ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:
  โ ุฅูุชุฑูุช ุจุทูุก ุฌุฏุงู (< 1 Mbps)
  โ ุงูููู ุชุงูู ุฃู ุจู ูุดููุฉ
  โ ูุดููุฉ ูู Supabase Storage ููุณู

ุงูุญู:
  1. ุงูุญุต ุณุฑุนุฉ ุงูุฅูุชุฑูุช (speedtest.net)
  2. ุฌุฑุจ ููู ููุฏูู ุขุฎุฑ
  3. ุฌุฑุจ ุชุตุฏูุฑ ุงูููุฏูู ุจุฅุนุฏุงุฏุงุช ุฃุฎู:
     - 720p ุจุฏูุงู ูู 1080p
     - 30fps ุจุฏูุงู ูู 60fps
     - Bitrate ุฃูู (3-5 Mbps)
```

### ุงููุดููุฉ 2: ุงูุฑูุน ุจุทูุก ุฌุฏุงู

```
ุงูุฃุณุจุงุจ:
  โ ุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุฌูุงู (ุจุทูุก ููููู)
  โ Wi-Fi ุจุทูุก
  โ ุจุฑุงูุฌ ุฃุฎุฑู ุชุณุชููู ุงูุฅูุชุฑูุช

ุงูุญู:
  โ ุงุณุชุฎุฏู Wi-Fi ููู (ููุตู ุจู ุจุดุฏุฉ)
  โ ุฃุบูู ุงูุจุฑุงูุฌ ุงูุฃุฎุฑู
  โ ุฌุฑุจ ูู ููุช ุขุฎุฑ (ุฃูู ุงุฒุฏุญุงู)
```

### ุงููุดููุฉ 3: ูุชููู ุนูุฏ ูุณุจุฉ ูุนููุฉ

```
ุงูุฃุณุจุงุจ:
  โ ุงููุทุน ุงูุฅูุชุฑูุช
  โ ุฃุบููุช ุงูุตูุญุฉ ุนู ุทุฑูู ุงูุฎุทุฃ
  โ ููุฏุช ูุณุงุญุฉ ุงูุชุฎุฒูู

ุงูุญู:
  โ ุชุญูู ูู ุงูุงุชุตุงู
  โ ุงูุชุญ ุงูุตูุญุฉ ูุฑุฉ ุฃุฎุฑู - ุณูุณุชุฃูู (ููู chunked)
  โ ุชุญูู ูู ูุณุงุญุฉ ุงูุชุฎุฒูู ูู Supabase
```

---

## ๐จ ุชุญุณูู ุฌูุฏุฉ ุงูููุฏูู ููุฑูุน ุงูุฃุณุฑุน

### ุงูุฅุนุฏุงุฏุงุช ุงูููุตู ุจูุง:

```
ููููุฏูููุงุช ุงููุตูุฑุฉ (< ุฏูููุฉ):
  ุงูุฏูุฉ: 1080p
  FPS: 30
  Codec: H.264
  Bitrate: 5-8 Mbps
  ุงูุญุฌู ุงููุชููุน: ~25-40 MB

ููููุฏูููุงุช ุงููุชูุณุทุฉ (1-3 ุฏูุงุฆู):
  ุงูุฏูุฉ: 720p ุฃู 1080p
  FPS: 30
  Codec: H.264
  Bitrate: 3-5 Mbps
  ุงูุญุฌู ุงููุชููุน: ~50-150 MB

ููููุฏูููุงุช ุงูุทูููุฉ (> 3 ุฏูุงุฆู):
  ุงูุฏูุฉ: 720p
  FPS: 30
  Codec: H.264
  Bitrate: 2-3 Mbps
  ุงูุญุฌู ุงููุชููุน: ~100-300 MB
```

### ุฃุฏูุงุช ุถุบุท ุงูููุฏูู (ุฅุฐุง ูุฒู ุงูุฃูุฑ):

```
HandBrake (ูุฌุงูู):
  1. ุงูุชุญ ุงูููุฏูู
  2. ุงุฎุชุฑ "Fast 1080p30" preset
  3. ุชุฃูุฏ ูู H.264 codec
  4. ุงุถุบุท Start

Adobe Media Encoder (ุงุญุชุฑุงูู):
  1. ุงุณุชูุฑุฏ ุงูููุฏูู
  2. Format: H.264
  3. Preset: Match Source - Medium Bitrate
  4. Export
```

---

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### ูุง ุชุฑุงู ูู Console:

```
ููุฑูุน ุงูุจุณูุท (< 15 MB):
  ๐ค [SimpleUpload] Using simple upload for small file
  ๐ค [SimpleUpload] Attempt 1/3
  โ [SimpleUpload] Upload completed successfully

ููุฑูุน ุงููุชูุฏู (> 15 MB):
  ๐ฆ [AdvancedUpload] Starting advanced chunked upload
  ๐ File: video.mp4 | Size: 25.43 MB
  ๐ฆ [AdvancedUpload] File divided into 5 chunks (6.00 MB each)
  ๐ [AdvancedUpload] Uploading 5 remaining chunks
  ๐ Progress: 20.0% | Speed: 2.15 MB/s | Chunks: 1/5
  ๐ Progress: 40.0% | Speed: 2.32 MB/s | Chunks: 2/5
  ๐ Progress: 60.0% | Speed: 2.18 MB/s | Chunks: 3/5
  ๐ Progress: 80.0% | Speed: 2.26 MB/s | Chunks: 4/5
  ๐ Progress: 100.0% | Speed: 2.21 MB/s | Chunks: 5/5
  ๐ [AdvancedUpload] Finalizing upload...
  โ [AdvancedUpload] Upload completed successfully
```

---

## ๐ก ูุตุงุฆุญ ุฅุถุงููุฉ

### ููุญุตูู ุนูู ุฃูุถู ูุชุงุฆุฌ:

```
โ ุงุณุชุฎุฏู Wi-Fi ููู (10 Mbps ุฃู ุฃุนูู)
โ ุฃุบูู ุงูุจุฑุงูุฌ ุงูุฃุฎุฑู (Netflix, YouTube, Downloads)
โ ูุง ุชุบูู ุงูุตูุญุฉ ุฃุซูุงุก ุงูุฑูุน
โ ุงุณุชุฎุฏู H.264 codec (ุงูุฃูุซุฑ ุชูุงููุงู)
โ ุตุฏูุฑ ุจู 1080p @ 30fps ููุฌูุฏุฉ ุงูุนุงููุฉ
โ ุฃู 720p @ 30fps ููุญุฌู ุงูุฃุตุบุฑ
โ ุชุฃูุฏ ูู ุดุญู ุงูุจุทุงุฑูุฉ (ููุฌูุงู/ูุงุจุชูุจ)
```

### ุชุฌููุจ:

```
โ ุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูุฌูุงู (ุจุทูุก ููููู)
โ ุฑูุน ููุฏูู 4K (ุซููู ุฌุฏุงู)
โ ุงุณุชุฎุฏุงู codecs ุบุฑูุจุฉ (HEVC/H.265 ูุฏ ุชูุดู)
โ ุฅุบูุงู ุงูุตูุญุฉ ุฃู ุชุจุฏูู ุงูุชุทุจูู
โ ุฑูุน ุฃุซูุงุก ุงุณุชุฎุฏุงู ุงูุฅูุชุฑูุช ุจูุซุงูุฉ
```

---

## ๐ ุงูุฎูุงุตุฉ

### ูุง ุชู ุฅุตูุงุญู:

```
โ ุฅุถุงูุฉ timeout 10 ุฏูุงุฆู ููุฑูุน ุงูุจุณูุท
โ ุฅุถุงูุฉ 3 ูุญุงููุงุช ููุฑูุน ุงูุจุณูุท
โ ุชูููู ุนุชุจุฉ chunked upload ูู 30 MB ุฅูู 15 MB
โ ุชุญุณูู chunked upload (ูู ุงููุฑุฉ ุงูุณุงุจูุฉ):
   - 6 MB chunks
   - 4 parallel uploads
   - 5 retries per chunk
   - 5 minutes timeout per chunk
   - 10 GB max size
```

### ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:

```
๐ฏ ููุฏูู 33 ุซุงููุฉ โ ูุง ูุฒุงู ููุฌุญ โ
๐ฏ ููุฏูู 45 ุซุงููุฉ โ ุงูุขู ููุฌุญ! โ
๐ฏ ููุฏูู ุฏูููุฉ โ ููุฌุญ! โ
๐ฏ ููุฏูู ุฏูููุชูู โ ููุฌุญ! โ
๐ฏ ููุฏูู 10 ุฏูุงุฆู โ ููุฌุญ! โ
```

---

## ๐ ุงููููุงุช ุงููุนุฏููุฉ

### 1. advancedVideoUploadService.ts
```
ุงูุชุบููุฑุงุช:
  - uploadSimple(): ุฅุถุงูุฉ timeout 10 ุฏูุงุฆู
  - uploadSimple(): ุฅุถุงูุฉ retry mechanism (3 ูุญุงููุงุช)
  - uploadSimple(): ุฅุถุงูุฉ exponential backoff
```

### 2. VideoIntroManager.tsx
```
ุงูุชุบููุฑุงุช:
  - ุชูููู ุนุชุจุฉ chunked upload ูู 30 MB ุฅูู 15 MB
  - ุชุญุฏูุซ ุฑุณุงุฆู ุงููุณุชุฎุฏู
```

---

**๐ ุงููุธุงู ุงูุขู ุฌุงูุฒ! ุฌุฑูุจ ุฑูุน ููุฏูู 45 ุซุงููุฉ ูุณููุฌุญ ุจุฅุฐู ุงููู!**

ูููุฒูุฏ ูู ุงูุชูุงุตูู:
- `VIDEO_UPLOAD_ENHANCED_10GB.md` - ุงูุชุญุณููุงุช ุงูุณุงุจูุฉ (10 GB support)
- `ุฅุตูุงุญ_ุฑูุน_ุงูููุฏูู_10_ุฌูุฌุง.md` - ููุฎุต ุณุฑูุน ุจุงูุนุฑุจู
- `VIDEO_UPLOAD_TIMEOUT_FIX.md` - ูุฐุง ุงูููู (timeout fix)
