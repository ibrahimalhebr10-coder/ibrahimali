# ๐ ููุฎุต ุณุฑูุน - ุงููุฑุญูุฉ ุงูุซุงูุซุฉ

## โ ูุง ุชู ุฅูุฌุงุฒู

### ๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### 1. ุญูู ุฌุฏูุฏ ูู reservations
```sql
ALTER TABLE reservations
ADD COLUMN influencer_code text;
```
- ููุญูุธ ููุฏ ุงููุคุซุฑ ูุน ูู ุญุฌุฒ
- ุงุฎุชูุงุฑู (nullable)
- ุบูุฑ ูุงุจู ููุชุนุฏูู

---

#### 2. ุฏุงูุฉ ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
```sql
update_influencer_stats_after_payment(
  code, trees, reservation_id
)
```

**ูุง ุชูุนูู:**
- ุชุจุญุซ ุนู ุงููุคุซุฑ
- ุชุญุฏูุซ total_bookings (+1)
- ุชุญุฏูุซ total_trees_booked (+X)
- ุชุญุณุจ ุงูููุงูุขุช (ูู 20 = 1)

---

### ๐ป Frontend

#### AgriculturalFarmPage & InvestmentFarmPage

**ุงูุชุนุฏูู 1:** ุญูุธ ุงูููุฏ ูุน ุงูุญุฌุฒ
```typescript
influencer_code: influencerCode || null
```

**ุงูุชุนุฏูู 2:** ุชุญุฏูุซ ุจุนุฏ ุงูุฏูุน
```typescript
if (influencerCode) {
  await supabase.rpc('update_influencer_stats_after_payment', {
    p_influencer_code: influencerCode,
    p_trees_count: treeCount,
    p_reservation_id: reservation.id
  });
}
```

---

## ๐ ุณูุฑ ุงูุนูู

```
ุฅุฏุฎุงู ุงูููุฏ
    โ
ุงูุญุฌุฒ (ูุน ุงูููุฏ)
    โ
ุงูุฏูุน
    โ
ุชุฃููุฏ (status = confirmed)
    โ
ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ โ
```

---

## ๐ ุญุณุงุจ ุงูููุงูุขุช

### ุงููุงุนุฏุฉ:
```
ูู 20 ุดุฌุฑุฉ = 1 ุดุฌุฑุฉ ููุงูุฃุฉ
```

### ุฃูุซูุฉ:
```
50 ุฃุดุฌุงุฑ โ 2 ููุงูุขุช
90 ุฃุดุฌุงุฑ โ 4 ููุงูุขุช
150 ุฃุดุฌุงุฑ โ 7 ููุงูุขุช
```

---

## ๐ ุงูุชุญูู

### ูู Console:
```
โ ุชู ุชุฃููุฏ ุงูุญุฌุฒ ุจูุฌุงุญ!
๐ ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ...
โ ุชู ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ
```

### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```sql
-- ุงูุญุฌุฒ
SELECT influencer_code FROM reservations;

-- ุงูุฅุญุตุงุฆูุงุช
SELECT total_bookings, total_trees_booked, total_rewards_earned
FROM influencer_partners;
```

---

## โ ูุนุงููุฑ ุงููุฌุงุญ

| ุงููุนูุงุฑ | ุงูุญุงูุฉ |
|---------|--------|
| ุญูุธ ุงูููุฏ ูุน ุงูุญุฌุฒ | โ |
| ุงูุชุญุฏูุซ ุจุนุฏ ุงูุฏูุน ููุท | โ |
| ุญุณุงุจ ุงูููุงูุขุช ุฏููู | โ |
| ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก | โ |
| ุงูุชุณุฌูู ุงูุดุงูู | โ |

---

## ๐ฏ ุงูููุงุนุฏ ุงููุทุจูุฉ

### โ ูุง ุงุญุชุณุงุจ ูุจู ุงูุฏูุน
ุงูุชุญุฏูุซ ูุญุฏุซ ุจุนุฏ `status = 'confirmed'`

### โ ูุง ุงุญุชุณุงุจ ุนูู ุงูุฒูุงุฑุฉ
ูุง ููุฌุฏ ุฃู ุชุญุฏูุซ ุนูุฏ ูุชุญ ุงูุตูุญุฉ ุฃู ุฅุฏุฎุงู ุงูููุฏ

### โ ุงูุญุฌุฒ ูู ุงูุญุฏุซ ุงููุญูุฏ
ููุท ุงูุญุฌูุฒุงุช ุงููุคูุฏุฉ ูุงููุฏููุนุฉ ุชูุญุณุจ

---

## ๐ ุงููููุงุช

### Database:
- `add_influencer_code_to_reservations.sql`
- `create_influencer_reward_function.sql`

### Frontend:
- `AgriculturalFarmPage.tsx`
- `InvestmentFarmPage.tsx`

---

## ๐งช ุงูุงุฎุชุจุงุฑ

```bash
npm run build
```

**ุงููุชูุฌุฉ:** โ **ูุฌุญ ุจุฏูู ุฃุฎุทุงุก**

---

## ๐ ุงูุฎูุงุตุฉ

| ุงููุธููุฉ | ุงูุญุงูุฉ |
|---------|--------|
| ุฑุจุท ุงูููุฏ ุจุงูุญุฌุฒ | โ |
| ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช | โ |
| ุญุณุงุจ ุงูููุงูุขุช | โ |
| ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก | โ |
| **ุฌุงูุฒ ููุฅูุชุงุฌ** | **โ** |

---

**ุงููุฑุญูุฉ ุงูุซุงูุซุฉ ููุชููุฉ ุจูุฌุงุญ!**

ุงูุชุงุฑูุฎ: 5 ูุจุฑุงูุฑ 2026
