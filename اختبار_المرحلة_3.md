# ๐งช ุฏููู ุงุฎุชุจุงุฑ ุงููุฑุญูุฉ ุงูุซุงูุซุฉ

## ๐ฏ ูุง ูุฎุชุจุฑูุ

ุงููุฑุญูุฉ ุงูุซุงูุซุฉ ุชุฑุจุท ููุฏ ุงููุคุซุฑ ูุน ุงูุญุฌุฒ ูุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ุจุนุฏ ุงูุฏูุน.

---

## โ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ ุงููุงููุฉ

### ุงููุชุทูุจุงุช:
1. ูุคุซุฑ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ููุฏ ุฅุญุงูุฉ ูุซู: `ุงุญูุฏ_ุงููุฒุงุฑุน`
3. ูุฒุฑุนุฉ ูุชุงุญุฉ ููุญุฌุฒ

---

### ุงูุงุฎุชุจุงุฑ 1: ุญุฌุฒ ูุน ููุฏ ูุคุซุฑ

#### ุงูุฎุทูุงุช:

```
1. ุงูุชุญ ุตูุญุฉ ูุฒุฑุนุฉ
   โ
2. ุฃุฏุฎู ููุฏ ุงููุคุซุฑ: ุงุญูุฏ_ุงููุฒุงุฑุน
   (ุฑุณุงูุฉ ูุจุฑูููู ุชุธูุฑ)
   โ
3. ุงุฎุชุฑ ุจุงูุฉ + ุนุฏุฏ ุฃุดุฌุงุฑ (ูุซูุงู 50)
   โ
4. ุงุถุบุท "ุงุญุฌุฒ ุงูุขู"
   โ
5. ุฑุงุฌุน ุงูุชูุงุตูู โ ุงุถุบุท "ุชุฃููุฏ"
   โ
6. ุณุฌูู ุงูุฏุฎูู (ุฅุฐุง ูุฒู)
   โ
7. ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน
   โ
8. ุงูุชุธุฑ ุญุชู ุชุธูุฑ ุดุงุดุฉ ูุฌุงุญ ุงูุญุฌุฒ
```

#### ูู Console ุงููุชุตูุญ (F12):

ูุฌุจ ุฃู ุชุฑู:
```
๐ [AGRICULTURAL] Influencer Code: ุงุญูุฏ_ุงููุฒุงุฑุน
๐พ [AGRICULTURAL] ุจุฏุก ุฅูุดุงุก ุงูุญุฌุฒ...
โ [AGRICULTURAL] ุชู ุฅูุดุงุก ุงูุญุฌุฒ! ID: xxx
๐ [AGRICULTURAL] ุชุญุฏูุซ ุงูุญุงูุฉ ุฅูู confirmed...
โ [AGRICULTURAL] ุชู ุชุฃููุฏ ุงูุญุฌุฒ ุจูุฌุงุญ!
๐ [AGRICULTURAL] ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ...
โ [AGRICULTURAL] ุชู ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ: {
  success: true,
  influencer_name: "ุฃุญูุฏ ุงููุฒุงุฑุน",
  total_trees: 50,
  total_rewards: 2,
  trees_added: 50
}
```

---

### ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

#### 1. ุงูุชุญูู ูู ุงูุญุฌุฒ:

```sql
SELECT
  id,
  farm_name,
  total_trees,
  status,
  influencer_code,
  created_at
FROM reservations
WHERE influencer_code = 'ุงุญูุฏ_ุงููุฒุงุฑุน'
ORDER BY created_at DESC
LIMIT 1;
```

**ูุฌุจ ุฃู ุชุฑู:**
- `status`: `confirmed`
- `influencer_code`: `ุงุญูุฏ_ุงููุฒุงุฑุน`
- `total_trees`: 50

---

#### 2. ุงูุชุญูู ูู ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ:

```sql
SELECT
  partner_name,
  referral_code,
  total_bookings,
  total_trees_booked,
  total_rewards_earned
FROM influencer_partners
WHERE referral_code = 'ุงุญูุฏ_ุงููุฒุงุฑุน';
```

**ูุฌุจ ุฃู ุชุฑู:**
- `total_bookings`: ุฒุงุฏ ุจููุฏุงุฑ 1
- `total_trees_booked`: ุฒุงุฏ ุจููุฏุงุฑ 50
- `total_rewards_earned`: ุญูุณุจุช (ุงูุฃุดุฌุงุฑ / 20)

**ูุซุงู:**
- ูุจู: 100 ุดุฌุฑุฉ โ 5 ููุงูุขุช
- ุจุนุฏ: 150 ุดุฌุฑุฉ โ 7 ููุงูุขุช

---

### ุงูุงุฎุชุจุงุฑ 2: ุญุฌุฒ ุจุฏูู ููุฏ

#### ุงูุฎุทูุงุช:

```
1. ุงูุชุญ ุตูุญุฉ ูุฒุฑุนุฉ
   (ูุง ุชูุฏุฎู ุฃู ููุฏ)
   โ
2. ุงุฎุชุฑ ุจุงูุฉ + ุฃุดุฌุงุฑ
   โ
3. ุฃููู ุงูุญุฌุฒ ุญุชู ุงูุฏูุน
```

#### ูู Console:

ูุฌุจ ุฃู ุชุฑู:
```
๐พ [AGRICULTURAL] ุจุฏุก ุฅูุดุงุก ุงูุญุฌุฒ...
โ [AGRICULTURAL] ุชู ุฅูุดุงุก ุงูุญุฌุฒ!
โ [AGRICULTURAL] ุชู ุชุฃููุฏ ุงูุญุฌุฒ ุจูุฌุงุญ!
```

**ูุง ูุฌุจ ุฃู ุชุฑู:**
```
๐ [AGRICULTURAL] ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ...
```

---

#### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```sql
SELECT influencer_code
FROM reservations
WHERE id = 'ุงูุญุฌุฒ_ุงูุฃุฎูุฑ';
```

**ูุฌุจ ุฃู ุชุฑู:**
- `influencer_code`: `NULL`

---

### ุงูุงุฎุชุจุงุฑ 3: ููุฏ ูุคุซุฑ ุบูุฑ ููุฌูุฏ

#### ุงูุฎุทูุงุช:

```
1. ุงูุชุญ ุตูุญุฉ ูุฒุฑุนุฉ
   โ
2. ุฃุฏุฎู ููุฏ ุบูุฑ ููุฌูุฏ: ููุฏ_ูููู
   (ุฑุณุงูุฉ ูุจุฑูููู ุชุธูุฑ - ูุฐุง ุนุงุฏู)
   โ
3. ุฃููู ุงูุญุฌุฒ ุญุชู ุงูุฏูุน
```

#### ูู Console:

ูุฌุจ ุฃู ุชุฑู:
```
๐ [AGRICULTURAL] ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ...
โ๏ธ [AGRICULTURAL] ูุดู ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ: ููุฏ ุงููุคุซุฑ ุบูุฑ ููุฌูุฏ
```

**ุงูุญุฌุฒ ููููู ุจูุฌุงุญ** ููู ูุง ูุชู ุชุญุฏูุซ ุฃู ูุคุซุฑ.

---

#### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```sql
-- ุงูุญุฌุฒ ููุฌูุฏ ูุน ุงูููุฏ
SELECT influencer_code
FROM reservations
WHERE id = 'ุงูุญุฌุฒ_ุงูุฃุฎูุฑ';
-- ุงููุชูุฌุฉ: ููุฏ_ูููู

-- ููู ูุง ููุฌุฏ ูุคุซุฑ ุจูุฐุง ุงูููุฏ
SELECT * FROM influencer_partners
WHERE referral_code = 'ููุฏ_ูููู';
-- ุงููุชูุฌุฉ: ูุงุฑุบุฉ
```

---

### ุงูุงุฎุชุจุงุฑ 4: ูุคุซุฑ ุบูุฑ ููุนูู

#### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```sql
-- ุนุทูู ูุคุซุฑ ููุฌูุฏ
UPDATE influencer_partners
SET is_active = false
WHERE referral_code = 'ุงุญูุฏ_ุงููุฒุงุฑุน';
```

#### ุซู ูู ุจุญุฌุฒ:

```
1. ุฃุฏุฎู ุงูููุฏ: ุงุญูุฏ_ุงููุฒุงุฑุน
2. ุฃููู ุงูุญุฌุฒ
```

#### ูู Console:

```
๐ [AGRICULTURAL] ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ...
โ๏ธ [AGRICULTURAL] ูุดู ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ: ููุฏ ุงููุคุซุฑ ุบูุฑ ููุฌูุฏ ุฃู ุบูุฑ ููุนูู
```

---

### ุงูุงุฎุชุจุงุฑ 5: ุญุณุงุจ ุงูููุงูุขุช

#### ุงูุณููุงุฑูู:

```
ุงููุคุซุฑ: ุงุญูุฏ_ุงููุฒุงุฑุน
ูุจู ุงูุงุฎุชุจุงุฑ:
  total_trees_booked: 90
  total_rewards_earned: 4  (90 / 20 = 4.5 โ 4)

ุงูุญุฌุฒ ุงูุฌุฏูุฏ: 30 ุดุฌุฑุฉ

ุจุนุฏ ุงูุงุฎุชุจุงุฑ:
  total_trees_booked: 120
  total_rewards_earned: 6  (120 / 20 = 6)
```

#### ุงูุชุญูู:

```sql
SELECT
  total_trees_booked,
  total_rewards_earned,
  FLOOR(total_trees_booked / 20.0) as calculated_rewards
FROM influencer_partners
WHERE referral_code = 'ุงุญูุฏ_ุงููุฒุงุฑุน';
```

**ูุฌุจ ุฃู:**
```
total_rewards_earned = calculated_rewards
```

---

## ๐ ุญุงูุงุช ุงูุงุฎุชุจุงุฑ ุงูุฅุถุงููุฉ

### ุญุงูุฉ 1: ุญุฌุฒ ุตุบูุฑ (ุฃูู ูู 20 ุดุฌุฑุฉ)

```
ุงูุญุฌุฒ: 10 ุฃุดุฌุงุฑ
ุงููุคุซุฑ ูุจู: 5 ุฃุดุฌุงุฑ โ 0 ููุงูุขุช
ุงููุคุซุฑ ุจุนุฏ: 15 ุดุฌุฑุฉ โ 0 ููุงูุขุช

โ ูู ูุญุตู ุนูู ููุงูุฃุฉ (ุตุญูุญ)
```

---

### ุญุงูุฉ 2: ุงููุตูู ูุญุฏ ุงูููุงูุฃุฉ

```
ุงูุญุฌุฒ: 15 ุดุฌุฑุฉ
ุงููุคุซุฑ ูุจู: 95 ุดุฌุฑุฉ โ 4 ููุงูุขุช
ุงููุคุซุฑ ุจุนุฏ: 110 ุดุฌุฑุฉ โ 5 ููุงูุขุช

โ ุญุตู ุนูู ููุงูุฃุฉ ุฌุฏูุฏุฉ!
```

---

### ุญุงูุฉ 3: ุญุฌุฒ ูุจูุฑ

```
ุงูุญุฌุฒ: 100 ุดุฌุฑุฉ
ุงููุคุซุฑ ูุจู: 50 ุดุฌุฑุฉ โ 2 ููุงูุขุช
ุงููุคุซุฑ ุจุนุฏ: 150 ุดุฌุฑุฉ โ 7 ููุงูุขุช

โ ุญุตู ุนูู 5 ููุงูุขุช ุฅุถุงููุฉ!
```

---

## ๐ ุชูุฑูุฑ ุงุฎุชุจุงุฑ ููุงุฆู

### ุฌุฏูู ุงูุงุฎุชุจุงุฑุงุช:

| ุงูุงุฎุชุจุงุฑ | ุงูุญุงูุฉ ุงููุชููุนุฉ | ุงููุชูุฌุฉ |
|----------|------------------|----------|
| ุญุฌุฒ ูุน ููุฏ ุตุญูุญ | โ ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช | โ |
| ุญุฌุฒ ุจุฏูู ููุฏ | โ ูุง ุชุญุฏูุซ | โ |
| ููุฏ ุบูุฑ ููุฌูุฏ | โ๏ธ ุชุญุฐูุฑ ููุท | โ |
| ูุคุซุฑ ุบูุฑ ููุนูู | โ๏ธ ุชุญุฐูุฑ ููุท | โ |
| ุญุณุงุจ ุงูููุงูุขุช | โ ุฏููู 100% | โ |

---

## ๐ง ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ูุฏููุงู

### ููุงุฎุชุจุงุฑ ุงูุณุฑูุน:

```sql
-- ุงุฎุชุจุงุฑ ุงูุฏุงูุฉ ูุจุงุดุฑุฉ
SELECT update_influencer_stats_after_payment(
  'ุงุญูุฏ_ุงููุฒุงุฑุน'::text,
  25::integer,
  gen_random_uuid()
);
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "success": true,
  "message": "ุชู ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงููุคุซุฑ ุจูุฌุงุญ",
  "influencer_name": "ุฃุญูุฏ ุงููุฒุงุฑุน",
  "total_trees": 125,
  "total_rewards": 6,
  "trees_added": 25
}
```

---

## โ ูุนุงููุฑ ุงููุฌุงุญ

ุงูุงุฎุชุจุงุฑ ูุงุฌุญ ุฅุฐุง:

1. โ ุงูููุฏ ููุญูุธ ูุน ุงูุญุฌุฒ
2. โ ุงูุฅุญุตุงุฆูุงุช ุชุชุญุฏุซ ุจุนุฏ ุงูุฏูุน ููุท
3. โ ุญุณุงุจ ุงูููุงูุขุช ุฏููู (ูู 20 = 1)
4. โ ุงูุญุฌุฒ ููููู ุญุชู ูู ูุดู ุงูุชุญุฏูุซ
5. โ ุงูุชุณุฌูู ูุงุถุญ ูู Console
6. โ ูุง ุฃุฎุทุงุก ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ๐จ ูุดุงูู ูุญุชููุฉ ูุญููููุง

### ุงููุดููุฉ 1: "ุงูููุฏ ุบูุฑ ููุฌูุฏ"
**ุงูุญู:** ุชุฃูุฏ ุฃู ุงููุคุซุฑ ููุฌูุฏ ูู `influencer_partners`

### ุงููุดููุฉ 2: "ุงููุคุซุฑ ุบูุฑ ููุนูู"
**ุงูุญู:** `UPDATE influencer_partners SET is_active = true`

### ุงููุดููุฉ 3: ุงูููุงูุขุช ุบูุฑ ุฏูููุฉ
**ุงูุญู:** ุชุญูู ูู ุงูุญุณุงุจ: `FLOOR(total_trees / 20)`

### ุงููุดููุฉ 4: ูุง ููุฌุฏ ุชุญุฏูุซ
**ุงูุญู:** ุชุญูู ูู Console - ุฑุจูุง ุงูููุฏ ูุงุฑุบ

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุญุฌุฒ ูุง ููุดู ุฃุจุฏุงู** ุญุชู ูู ูุดู ุชุญุฏูุซ ุงููุคุซุฑ
2. **ุงูุชุณุฌูู ุดุงูู** ูู Console ูุชุชุจุน ูู ุดูุก
3. **ุงูุฏุงูุฉ ุขููุฉ** ูุน ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
4. **ุงูุชุญุฏูุซ ููุฑู** ุจุนุฏ ุชุฃููุฏ ุงูุฏูุน ูุจุงุดุฑุฉ

---

## ๐ ุงูุฎูุงุตุฉ

ุฅุฐุง ูุฌุญุช ุฌููุน ุงูุงุฎุชุจุงุฑุงุช:
- โ ุงููุธุงู ูุนูู ุจุดูู ุตุญูุญ
- โ ุงูุฑุจุท ูุน ุงูุญุฌูุฒุงุช ูุงุฌุญ
- โ ุญุณุงุจ ุงูููุงูุขุช ุฏููู
- โ ุฌุงูุฒ ููุฅูุชุงุฌ!

---

**ุญุธุงู ููููุงู ูู ุงูุงุฎุชุจุงุฑ!**

ุงูุชุงุฑูุฎ: 5 ูุจุฑุงูุฑ 2026
