# ุฅุตูุงุญ ุฎุทุฃ ูุฑุงุฌุนุฉ ุงูุงุณุชุซูุงุฑ (ุงูุฃุดุฌุงุฑ ุงูุฐูุจูุฉ)

## ุงููุดููุฉ

ุนูุฏ ูุญุงููุฉ ุชุฃููุฏ ุงูุงุณุชุซูุงุฑ ูู ุงูุฎุทูุฉ 3 (ูุฑุงุฌุนุฉ ุงูุงุณุชุซูุงุฑ)ุ ูุงู ูุธูุฑ ุงูุฎุทุฃ ุงูุชุงูู:

```
Error creating reservation: TypeError: Converting circular structure to JSON
    --> starting at object with constructor 'HTMLSpanElement'
```

## ุงูุณุจุจ ุงูุฌุฐุฑู

ุงููุดููุฉ ูุงูุช ูู ุนุฏู ุชุทุงุจู signatures ุงูุฏูุงู:

### ูุจู ุงูุฅุตูุงุญ โ

**ูู `InvestmentReviewScreen.tsx`:**
```typescript
interface InvestmentReviewScreenProps {
  onConfirm: () => void;  // โ ูุง ูุณุชูุจู parameters
}

<button onClick={onConfirm}>  // โ ูุณุชุฏุนู ุจุฏูู parameters
```

**ูู `UnifiedBookingFlow.tsx`:**
```typescript
const handleReviewConfirm = async (useFlexiblePayment: boolean = false) => {
  // โ ูุชููุน parameter
}

<InvestmentReviewScreen
  onConfirm={handleReviewConfirm}  // โ ุชูุฑูุฑ ุฏุงูุฉ ุชุชููุน parameter
/>
```

**ุงููุชูุฌุฉ:** ุนูุฏูุง ูุถุบุท ุงููุณุชุฎุฏู ุนูู ุฒุฑ ุงูุชุฃููุฏุ ูุชู ุงุณุชุฏุนุงุก `onConfirm()` ุจุฏูู parametersุ ููู `handleReviewConfirm` ูุชููุน parameterุ ููุง ูุณุจุจ ูุดุงูู ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช.

---

## ุงูุฅุตูุงุญ ุงููุทุจู

### 1๏ธโฃ ุชุญุฏูุซ Interface

**`InvestmentReviewScreen.tsx` ู `AgriculturalReviewScreen.tsx`:**

```typescript
interface InvestmentReviewScreenProps {
  onConfirm: (useFlexiblePayment?: boolean) => void;  // โ ูุณุชูุจู parameter ุงุฎุชูุงุฑู
  flexiblePaymentEnabled?: boolean;  // โ ุฌุฏูุฏ
  paymentGracePeriodDays?: number;   // โ ุฌุฏูุฏ
}
```

### 2๏ธโฃ ุชุญุฏูุซ ุงููููู ููุณุชูุจู Props ุงูุฌุฏูุฏุฉ

```typescript
export default function InvestmentReviewScreen({
  // ... props ุฃุฎุฑู
  onConfirm,
  flexiblePaymentEnabled = false,  // โ
  paymentGracePeriodDays = 7        // โ
}: InvestmentReviewScreenProps) {
```

### 3๏ธโฃ ุฅุถุงูุฉ ุฎูุงุฑุงุช ุงูุฏูุน

**ุจุฏูุงู ูู ุฒุฑ ูุงุญุฏุ ุฃุตุจุญ ููุงู ุฎูุงุฑุงู:**

#### ุฃ) ุฅุฐุง ูุงู ุงูุฏูุน ุงููุฑู ููุนูู (`flexiblePaymentEnabled = true`)

```typescript
{flexiblePaymentEnabled ? (
  <div className="space-y-4">
    {/* ุฒุฑ ุงูุฏูุน ุงูููุฑู */}
    <button onClick={() => onConfirm(false)}>
      ุชุฃููุฏ ุงูุงุณุชุซูุงุฑ ูุงูุฏูุน ุงูุขู
    </button>

    {/* ุฒุฑ ุงูุฏูุน ุงููุฑู */}
    <button onClick={() => onConfirm(true)}>
      ุชุฃููุฏ ูุงูุฏูุน ุฎูุงู {paymentGracePeriodDays} ุฃูุงู
    </button>
  </div>
) : (
  // ุฒุฑ ูุงุญุฏ ููุท ููุฏูุน ุงูููุฑู
  <button onClick={() => onConfirm(false)}>
    ุชุฃููุฏ ุงุณุชุซูุงุฑ ุฃุดุฌุงุฑู ูุงูุงูุชูุงู ููุฏูุน
  </button>
)}
```

---

## ุงููุชูุฌุฉ ุจุนุฏ ุงูุฅุตูุงุญ โ

### ุงูุณููู ุงูุฌุฏูุฏ

#### 1. ุนูุฏูุง flexiblePaymentEnabled = **false** (ุงูุชุฑุงุถู)
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ณ ุชุฃููุฏ ุงุณุชุซูุงุฑ ุฃุดุฌุงุฑู ูุงูุงูุชูุงู ููุฏูุน โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
- ุฒุฑ ูุงุญุฏ ููุท
- ุนูุฏ ุงูุถุบุท: `onConfirm(false)` โ ุงูุฏูุน ุงูููุฑู

#### 2. ุนูุฏูุง flexiblePaymentEnabled = **true**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ณ ุชุฃููุฏ ุงูุงุณุชุซูุงุฑ ูุงูุฏูุน ุงูุขู           โ  โ onConfirm(false)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โฐ ุชุฃููุฏ ูุงูุฏูุน ุฎูุงู 7 ุฃูุงู             โ  โ onConfirm(true)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
- ุฒุฑุงู ููุงุฎุชูุงุฑ
- ุงูุฃูู: ุฏูุน ููุฑู
- ุงูุซุงูู: ุฏูุน ูุฑู

---

## ุงูุชุฏูู ุงูุตุญูุญ ุงูุขู

### ุงููุณุงุฑ ุงูุฐูุจู (Investment Path)

```
1. ุงููุณุชุฎุฏู ูุฎุชุงุฑ ุจุงูุฉ ุงุณุชุซูุงุฑูุฉ
   โ
2. ูุตู ูุตูุญุฉ "ูุฑุงุฌุนุฉ ุงูุงุณุชุซูุงุฑ" (InvestmentReviewScreen)
   โ
3. ูุฎุชุงุฑ:
   ุฃ) "ุชุฃููุฏ ูุงูุฏูุน ุงูุขู" โ onConfirm(false)
   ุจ) "ุชุฃููุฏ ูุงูุฏูุน ุฎูุงู 7 ุฃูุงู" โ onConfirm(true)
   โ
4. ูู UnifiedBookingFlow.handleReviewConfirm(useFlexiblePayment):
   - ุฅุฐุง useFlexiblePayment = false:
     * status = 'pending'
     * ุงูุงูุชูุงู ูุจุงุดุฑุฉ ูุตูุญุฉ ุงูุฏูุน
   - ุฅุฐุง useFlexiblePayment = true:
     * status = 'pending_payment'
     * flexible_payment_enabled = true
     * payment_deadline = now + 7 days
     * ุงูุงูุชูุงู ูุตูุญุฉ ุงููุฌุงุญ
   โ
5. โ ูุชู ุฅูุดุงุก ุงูุญุฌุฒ ุจูุฌุงุญ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### ุงููุณุงุฑ ุงูุฃุฎุถุฑ (Agricultural Path)

ููุณ ุงูุชุฏููุ ููู:
- ุงูุฃููุงู ุฎุถุฑุงุก ุจุฏูุงู ูู ุฐูุจูุฉ
- ุงููุตูุต ูุฎุชููุฉ ููููุงู

---

## ุงููููุงุช ุงููุนุฏูุฉ

### 1. `InvestmentReviewScreen.tsx`
```diff
interface InvestmentReviewScreenProps {
-  onConfirm: () => void;
+  onConfirm: (useFlexiblePayment?: boolean) => void;
+  flexiblePaymentEnabled?: boolean;
+  paymentGracePeriodDays?: number;
}

-  <button onClick={onConfirm}>
+  <button onClick={() => onConfirm(false)}>
```

### 2. `AgriculturalReviewScreen.tsx`
ููุณ ุงูุชุนุฏููุงุช

### 3. `UnifiedBookingFlow.tsx`
ูุง ูุญุชุงุฌ ุชุนุฏููุ ูุงู ุตุญูุญุงู ูู ุงูุจุฏุงูุฉ

---

## ุงูุชุญูู ูู ุงูุฅุตูุงุญ

### ุงุฎุชุจุงุฑ 1: ุงููุณุงุฑ ุงูุฐูุจู (ุงูุฏูุน ุงูููุฑู)
```
1. ุงูุชุญ ุงููุณุงุฑ ุงูุงุณุชุซูุงุฑู
2. ุงุฎุชุฑ ุจุงูุฉ
3. ุฑุงุฌุน ุงูุงุณุชุซูุงุฑ
4. ุงุถุบุท "ุชุฃููุฏ ุงูุงุณุชุซูุงุฑ ูุงูุฏูุน ุงูุขู"
5. โ ูุฌุจ ุงูุงูุชูุงู ูุตูุญุฉ ุงูุฏูุน ุจุฏูู ุฃุฎุทุงุก
```

### ุงุฎุชุจุงุฑ 2: ุงููุณุงุฑ ุงูุฐูุจู (ุงูุฏูุน ุงููุฑู)
```
1. ูุนูู ุงูุฏูุน ุงููุฑู ูู ุงูุฅุนุฏุงุฏุงุช
2. ุงูุชุญ ุงููุณุงุฑ ุงูุงุณุชุซูุงุฑู
3. ุงุฎุชุฑ ุจุงูุฉ
4. ุฑุงุฌุน ุงูุงุณุชุซูุงุฑ
5. ุงุถุบุท "ุชุฃููุฏ ูุงูุฏูุน ุฎูุงู 7 ุฃูุงู"
6. โ ูุฌุจ ุงูุงูุชูุงู ูุตูุญุฉ ุงููุฌุงุญ ุจุฏูู ุฃุฎุทุงุก
```

### ุงุฎุชุจุงุฑ 3: ุงููุณุงุฑ ุงูุฃุฎุถุฑ
ููุณ ุงูุงุฎุชุจุงุฑุงุช ุงูุณุงุจูุฉ

---

## ููุงุญุธุงุช ูููุฉ

### โ ุชู ุงูุฅุตูุงุญ
- โ `Converting circular structure to JSON`
- โ ุนุฏู ุงูุงูุชูุงู ููุฎุทูุฉ ุงูุชุงููุฉ
- โ ุชุทุงุจู signatures ุงูุฏูุงู
- โ ุฏุนู ุงูุฏูุน ุงููุฑู/ุงูููุฑู

### ๐จ ุงููุญุงูุธุฉ ุนูู ุงูุชุตููู
- ุฌููุน ุงูุชุตุงููู ุงูุฐูุจูุฉ ูุญููุธุฉ
- ุฌููุน ุงูุชุตุงููู ุงูุฎุถุฑุงุก ูุญููุธุฉ
- ุงูุฃููุงู ูุงูุชูุณูู ูู ูุชุบูุฑ

### ๐ ุงูุชูุงูููุฉ
- ุงููุณุงุฑ ุงูุฒุฑุงุนู (Agricultural): โ ูุนูู
- ุงููุณุงุฑ ุงูุงุณุชุซูุงุฑู (Investment): โ ูุนูู
- ุงูุฏูุน ุงูููุฑู: โ ูุนูู
- ุงูุฏูุน ุงููุฑู: โ ูุนูู

---

## ุงูุฎูุงุตุฉ

### ุงููุดููุฉ ูุงูุช:
- ุนุฏู ุชุทุงุจู signature ุงูุฏูุงู ุจูู `InvestmentReviewScreen` ู `handleReviewConfirm`
- ูู ุชูู ููุงู ุทุฑููุฉ ูุชูุฑูุฑ ุฎูุงุฑ ุงูุฏูุน (ููุฑู/ูุฑู)

### ุงูุญู:
- โ ุชุญุฏูุซ interface ููุณุชูุจู parameter
- โ ุฅุถุงูุฉ ุฎูุงุฑุงุช ุงูุฏูุน ุงููุฑู
- โ ุชุทุจูู ููุณ ุงูุฅุตูุงุญ ุนูู ููุง ุงููุณุงุฑูู

### ุงููุชูุฌุฉ:
- โ ูุนูู ุชุฃููุฏ ุงูุงุณุชุซูุงุฑ ุจูุฌุงุญ
- โ ุงูุงูุชูุงู ููุฎุทูุฉ ุงูุชุงููุฉ ูุนูู
- โ ุฏุนู ูุงูู ููุฏูุน ุงููุฑู/ุงูููุฑู

---

## ุงูุชุทุจูู

```bash
โ ุชู ุชุทุจูู ุงูุฅุตูุงุญ
โ ุชู ุงูุจูุงุก ุจูุฌุงุญ (npm run build)
โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ
```

**ุงุฎุชุจุฑ ุงูุขู ุงููุณุงุฑ ุงูุฐูุจู ูุณุชุฑู ุฃูู ูุนูู ุจุดูู ุตุญูุญ!** ๐
