# ุฏููู ูุธุงู ุจูุงุจุงุช ุงูุฏูุน - ุงูุจุทุงูุงุช ุงููุงููุฉ

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชูููุฐ ูุธุงู ุดุงูู ูุฅุฏุงุฑุฉ ุจูุงุจุงุช ุงูุฏูุน ูู ููุญุฉ ุงูุชุญููุ ูุดูู 5 ุจูุงุจุงุช ุฑุฆูุณูุฉ ุฌุงูุฒุฉ ููุฑุจุท ุงูููุฑู.

---

## ๐ ุงููููุน ูู ุงููุธุงู

```
ููุญุฉ ุงูุชุญูู โ ุงูุฅุนุฏุงุฏุงุช โ ุงูุจุทุงูุงุช ุงููุงููุฉ
```

---

## ๐ ุงูุจูุงุจุงุช ุงููุชููุฑุฉ

### 1. ูุฏู (Mada)
- **ุงูููุน**: ุจุทุงูุงุช ูุฏู ุงูุณุนูุฏูุฉ
- **ุงูุจูุฆุงุช**: Sandbox / Production
- **ุงููุชุทูุจุงุช**:
  - API Key
  - Secret Key
  - Merchant ID
- **ุงูููุฒุงุช**:
  - ุฏุนู 3D Secure
  - ุงูุชุณููุฉ: 24-48 ุณุงุนุฉ
  - ุงูุนููุงุช: SAR ููุท

### 2. ููุฒุง/ูุงุณุชุฑูุงุฑุฏ (Visa/Mastercard)
- **ุงูููุน**: ุจุทุงูุงุช ุฏูููุฉ
- **ุงูุจูุฆุงุช**: Sandbox / Production
- **ุงููุชุทูุจุงุช**:
  - API Key
  - Secret Key
  - Merchant ID
- **ุงูููุฒุงุช**:
  - ุฏุนู 3D Secure
  - ุงูุชุณููุฉ: 48-72 ุณุงุนุฉ
  - ุงูุนููุงุช: SAR, USD, EUR

### 3. ุชูุงุฑุง (Tamara)
- **ุงูููุน**: ุงุดุชุฑู ุงูุขู ูุงุฏูุน ูุงุญูุงู (BNPL)
- **ุงูุจูุฆุงุช**: Sandbox / Production
- **ุงููุชุทูุจุงุช**:
  - API Key
  - Secret Key
  - Webhook URL
  - Webhook Secret
- **ุงูููุฒุงุช**:
  - ุฎุทุท ุงูุชูุณูุท: 1, 3, 6, 12 ุดูุฑ
  - ุงูุญุฏ ุงูุฃุฏูู: 100 ุฑ.ุณ
  - ุงูุญุฏ ุงูุฃูุตู: 20,000 ุฑ.ุณ
  - ุงูุชุณููุฉ: ููุฑูุฉ

### 4. ุชุงุจู (Tabby)
- **ุงูููุน**: ุงุดุชุฑู ุงูุขู ูุงุฏูุน ูุงุญูุงู (BNPL)
- **ุงูุจูุฆุงุช**: Sandbox / Production
- **ุงููุชุทูุจุงุช**:
  - API Key
  - Secret Key
  - Webhook URL
  - Webhook Secret
- **ุงูููุฒุงุช**:
  - ุฎุทุท ุงูุชูุณูุท: 4 ุฏูุนุงุชุ ุงุฏูุน ูุงุญูุงู
  - ุงูุญุฏ ุงูุฃุฏูู: 100 ุฑ.ุณ
  - ุงูุญุฏ ุงูุฃูุตู: 5,000 ุฑ.ุณ
  - ุงูุชุณููุฉ: ููุฑูุฉ

### 5. ุชุญููู ุจููู (Bank Transfer)
- **ุงูููุน**: ุชุญููู ุจููู ูุจุงุดุฑ
- **ุงูุจูุฆุฉ**: Production (ุฏุงุฆูุงู)
- **ุงููุชุทูุจุงุช**: ูุง ููุฌุฏ (ุฌุงูุฒ ููุงุณุชุฎุฏุงู)
- **ุงูููุฒุงุช**:
  - ูุง ุญุฏูุฏ ุนูู ุงููุจุงูุบ
  - ูุญุชุงุฌ ุชุฃููุฏ ูุฏูู
  - ุงูุนููุงุช: SAR

---

## ๐ฏ ุงููุธุงุฆู ุงููุชุงุญุฉ

### 1. ุฅุฏุงุฑุฉ ุงูุจูุงุจุฉ
- โ ุชูุนูู/ุชุนุทูู ุงูุจูุงุจุฉ
- โ ุงูุชุจุฏูู ุจูู ุงูุจูุฆุงุช (Sandbox/Production)
- โ ุญูุธ ููุงุชูุญ ุงูุฑุจุท
- โ ุฅุฎูุงุก/ุฅุธูุงุฑ ุงูููุงุชูุญ ุงูุญุณุงุณุฉ
- โ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

### 2. ุงูุฅุนุฏุงุฏุงุช
ูู ุจูุงุจุฉ ุชุญุชูู ุนูู:
- ููุชุงุญ API
- ุงูููุชุงุญ ุงูุณุฑู
- ูุนุฑู ุงูุชุงุฌุฑ (ููุจุทุงูุงุช)
- ุฑุงุจุท Webhook (ูุชูุงุฑุง ูุชุงุจู)
- ุณุฑ Webhook (ูุชูุงุฑุง ูุชุงุจู)
- ุงูุจูุฆุฉ (ุชุฌุฑูุจู/ุฅูุชุงุฌ)

### 3. ุงููุฑุงูุจุฉ
- ุญุงูุฉ ุงูุงุชุตุงู (ูุชุตู/ุบูุฑ ูุชุตู/ุฌุงุฑู ุงูุงุฎุชุจุงุฑ/ุฎุทุฃ)
- ุขุฎุฑ ุงุฎุชุจุงุฑ ุงุชุตุงู
- ุณุฌู ุงููุนุงููุงุช

---

## ๐พ ุงูุจููุฉ ุงูุชุญุชูุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ุฌุฏูู `payment_providers`
```sql
- id (uuid)
- provider_code (text)
- provider_name_ar (text)
- provider_name_en (text)
- is_enabled (boolean)
- environment (sandbox/production)
- connection_status (connected/disconnected/testing/error)
- api_key (text)
- secret_key (text)
- merchant_id (text)
- webhook_url (text)
- webhook_secret (text)
- configuration (jsonb)
- last_test_at (timestamp)
- last_test_status (text)
```

#### ุฌุฏูู `payment_provider_transactions_log`
```sql
- id (uuid)
- provider_id (uuid)
- transaction_type (payment/refund/test)
- transaction_status (success/failed/pending)
- amount (numeric)
- currency (text)
- external_transaction_id (text)
- request_data (jsonb)
- response_data (jsonb)
- error_message (text)
```

### ุงูุฏูุงู ุงููุณุงุนุฏุฉ

1. **test_provider_connection(provider_id)**
   - ุงุฎุชุจุงุฑ ุงุชุตุงู ุงูุจูุงุจุฉ
   - ุชุณุฌูู ูุชูุฌุฉ ุงูุงุฎุชุจุงุฑ

2. **get_providers_statistics()**
   - ุฅุญุตุงุฆูุงุช ุดุงููุฉ ููู ุงูุจูุงุจุงุช
   - ุนุฏุฏ ุงููุนุงููุงุช ุงููุงุฌุญุฉ/ุงููุงุดูุฉ
   - ุฅุฌูุงูู ุงููุจุงูุบ

---

## ๐ ุงูุฃูุงู

### ุณูุงุณุงุช RLS
- ุงููุดุฑููู ููุท ูููููู ุงููุตูู ููุจูุงุจุงุช
- ุงูููุงุชูุญ ุงูุญุณุงุณุฉ ูุฎููุฉ ุงูุชุฑุงุถูุงู
- ุณุฌู ูุงูู ููู ุงูุนูููุงุช ูู audit log

### ุงูุชุดููุฑ
- ุฌููุน ุงูููุงุชูุญ ูุญููุธุฉ ุจุดูู ุขูู
- ูููู ุฅุถุงูุฉ ุทุจูุฉ ุชุดููุฑ ุฅุถุงููุฉ ูุณุชูุจูุงู

---

## ๐ ุฎุทูุงุช ุงูุฑุจุท ุงูุณุฑูุน

### ุงูุจูุงุจุงุช ุงูุนุงุฏูุฉ (ูุฏูุ ููุฒุง)
1. ุงูุชุญ ููุญุฉ ุงูุชุญูู
2. ุงูุฅุนุฏุงุฏุงุช โ ุงูุจุทุงูุงุช ุงููุงููุฉ
3. ุงุถุบุท "ุฅุนุฏุงุฏุงุช ุงูุฑุจุท" ุนูู ุงูุจูุงุจุฉ ุงููุทููุจุฉ
4. ุฃุฏุฎู:
   - ููุชุงุญ API
   - ุงูููุชุงุญ ุงูุณุฑู
   - ูุนุฑู ุงูุชุงุฌุฑ
5. ุงุญูุธ ุงูุฅุนุฏุงุฏุงุช
6. ุงุถุบุท "ุงุฎุชุจุงุฑ ุงูุงุชุตุงู"
7. ูุนูู ุงูุจูุงุจุฉ

### ุจูุงุจุงุช BNPL (ุชูุงุฑุงุ ุชุงุจู)
1. ููุณ ุงูุฎุทูุงุช ุฃุนูุงู +
2. ุฃุฏุฎู:
   - ุฑุงุจุท Webhook
   - ุณุฑ Webhook
3. ุงุญูุธ ููุนูู

### ุงูุชุญููู ุงูุจููู
- ุฌุงูุฒ ููุงุณุชุฎุฏุงู ูุจุงุดุฑุฉ
- ูุง ูุญุชุงุฌ ุฃู ุฅุนุฏุงุฏุงุช

---

## ๐ ุงููุฑุงูุจุฉ ูุงูุฅุญุตุงุฆูุงุช

### ุญุงูุฉ ุงูุงุชุตุงู
- ๐ข **ูุชุตู**: ุงูุจูุงุจุฉ ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู
- โช **ุบูุฑ ูุชุตู**: ูู ูุชู ุงูุฑุจุท ุจุนุฏ
- ๐ก **ุฌุงุฑู ุงูุงุฎุชุจุงุฑ**: ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุฌุงุฑู
- ๐ด **ุฎุทุฃ**: ูุดู ุงูุงุชุตุงู

### ุงูุฅุญุตุงุฆูุงุช ุงููุชุงุญุฉ
- ุฅุฌูุงูู ุงููุนุงููุงุช
- ุงููุนุงููุงุช ุงููุงุฌุญุฉ
- ุงููุนุงููุงุช ุงููุงุดูุฉ
- ุฅุฌูุงูู ุงููุจุงูุบ
- ุขุฎุฑ ูุนุงููุฉ

---

## ๐ง ุงููููุงุช ุงููููุฐุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช
```
supabase/migrations/
โโโ enhance_payment_providers_table_fixed.sql
โโโ seed_saudi_payment_providers.sql
```

### ุงูุฎุฏูุงุช
```
src/services/
โโโ paymentProvidersService.ts
```

### ุงููุงุฌูุฉ
```
src/components/admin/
โโโ PaymentProvidersManager.tsx
โโโ GeneralSettings.tsx (ูุญุฏูุซ)
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ูุง Placeholder**: ูู ุดูุก ุญูููู ูุฌุงูุฒ ููุฑุจุท ุงูููุฑู
2. **ุงูุจูุฆุฉ ุงูุชุฌุฑูุจูุฉ**: ุงุณุชุฎุฏููุง ููุงุฎุชุจุงุฑ ูุจู ุงูุฅูุชุงุฌ
3. **ุงูุฃูุงู**: ูุง ุชุดุงุฑู ุงูููุงุชูุญ ูุน ุฃู ุดุฎุต
4. **ุงูุชูุซูู**: ูู ุจูุงุจุฉ ููุง configuration ุฎุงุต ูู JSONB
5. **ุงูุชูุณุน**: ุณูู ุฅุถุงูุฉ ุจูุงุจุงุช ุฌุฏูุฏุฉ

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงูููุฒุงุช
- ุชุตููู ุงุญุชุฑุงูู ุจูุธุงู Cards
- ุฃููุงู ูููุฒุฉ ููู ุจูุงุจุฉ
- Toggle switches ุณููุฉ ุงูุงุณุชุฎุฏุงู
- ุฅุฎูุงุก/ุฅุธูุงุฑ ุงูููุงุชูุญ ุงูุญุณุงุณุฉ
- ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุถุบุทุฉ ูุงุญุฏุฉ
- ููุงุฐุฌ ููุจุซูุฉ (Modals) ููุฅุนุฏุงุฏุงุช

### ุงูุฑููุฒ
- ๐ณ ูุฏู
- ๐ฐ ููุฒุง/ูุงุณุชุฑูุงุฑุฏ
- ๐๏ธ ุชูุงุฑุง
- ๐ฑ ุชุงุจู
- ๐ฆ ุชุญููู ุจููู

---

## โ ุงูุญุงูุฉ

**ุงููุธุงู ุฌุงูุฒ 100% ููุงุจู ููุงุณุชุฎุฏุงู ุงูููุฑู**

ุฌููุน ุงูุจูุงุจุงุช ุฌุงูุฒุฉ ููุฑุจุทุ ูุงููุงุฌูุฉ ููุชููุฉุ ููุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ.
ููุท ุฃุฏุฎู ุงูููุงุชูุญ ูู ุงูุจูุงุจุงุช ุงูุฎุงุฑุฌูุฉ ูุงุจุฏุฃ ุงูุงุณุชุฎุฏุงู.

---

ุชู ุงูุชูููุฐ ุจูุฌุงุญ โ
