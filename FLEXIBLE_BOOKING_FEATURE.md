# ميزة الحجز المرن - مع أو بدون باقة

## نظرة عامة

تم إضافة ميزة جديدة في صفحة **أشجاري الخضراء** تمنح العميل حرية الاختيار بين:

1. **الحجز مع باقة**: يختار من الباقات المعدة مسبقاً (عدد أشجار محدد + سعر مميز)
2. **الحجز بدون باقة**: حرية كاملة في اختيار عدد الأشجار (حجز مرن)

---

## الترتيب الجديد في صفحة الحجز

### المسار الزراعي (أشجاري الخضراء) فقط:

1. ✅ كود شريك النجاح (اختياري)
2. ✅ **اختيار نوع الحجز** (مع باقة / بدون باقة) ← جديد
3. ✅ اختيار الباقة (يظهر فقط إذا اختار "مع باقة")
4. ✅ عداد الأشجار
5. ✅ ملخص الحجز (يتكيف مع نوع الحجز)
6. ✅ زر "احجز الآن"

---

## كيف تعمل الميزة؟

### عند اختيار "مع باقة":
- تظهر كروت الباقات الثلاثة
- يتم تحديد عدد الأشجار حسب الباقة المختارة
- السعر يكون حسب سعر الباقة (سعر مميز)
- في الملخص يظهر: اسم الباقة + تفاصيل العقد

### عند اختيار "بدون باقة":
- تختفي كروت الباقات
- يذهب العميل مباشرة إلى عداد الأشجار
- حرية كاملة في اختيار العدد (من 1 إلى الحد الأقصى)
- السعر يكون حسب سعر العقد العادي
- في الملخص يظهر: "حجز مرن" + تفاصيل العقد

---

## الفوائد

### للعميل:
- ✅ **حرية الاختيار**: يختار الطريقة التي تناسبه
- ✅ **مرونة**: غير مقيد بعدد محدد إذا أراد ذلك
- ✅ **وضوح**: يفهم بوضوح الفرق بين الخيارين

### للمنصة:
- ✅ **تحسين التحويل**: العميل المتردد يمكنه الحجز بدون باقة
- ✅ **تجربة مستخدم أفضل**: تقليل الاحتكاك في عملية الحجز
- ✅ **مرونة تسويقية**: يمكن عرض الباقات كعروض مميزة

---

## التفاصيل التقنية

### الملفات المعدلة:
- `src/components/AgriculturalFarmPage.tsx`

### State الجديد:
```typescript
const [usePackage, setUsePackage] = useState(true);
```

### الدوال الجديدة:
```typescript
const handleTogglePackageMode = (withPackage: boolean) => {
  // تبديل بين الوضعين
  // إعادة تعيين القيم حسب الخيار
}
```

### التعديلات على الحسابات:
- `calculateTotal()`: تعمل مع كلا الحالتين
- `handleBuyNow()`: تتحقق من الشروط حسب نوع الحجز
- UnifiedBookingFlow: يستقبل اسم "حجز مرن" عند الحجز بدون باقة

---

## ملاحظات مهمة

1. ⚠️ هذه الميزة متاحة فقط في **المسار الزراعي** (أشجاري الخضراء)
2. ⚠️ **المسار الاستثماري** (الأشجار الذهبية) لا يزال يستخدم الباقات فقط
3. ✅ الافتراضي عند فتح الصفحة: "مع باقة"
4. ✅ كود الشريك يعمل في كلا الحالتين

---

## كيفية الاختبار

### السيناريو الأول: مع باقة
1. افتح مزرعة زراعية
2. تأكد أن "مع باقة" مفعل (افتراضياً)
3. اختر باقة
4. احجز

### السيناريو الثاني: بدون باقة
1. افتح مزرعة زراعية
2. اضغط على زر "بدون باقة"
3. اختر عدد الأشجار بحرية
4. احجز
5. تحقق من أن الملخص يظهر "حجز مرن"

### السيناريو الثالث: التبديل بين الوضعين
1. ابدأ بـ "مع باقة"
2. اختر باقة
3. اضغط على "بدون باقة"
4. تأكد من اختفاء الباقات
5. ارجع لـ "مع باقة"
6. تأكد من ظهور الباقات مرة أخرى
