# ุตูุญุฉ ุงูุณุฏุงุฏ ูู ุญุณุงุจ ุงููุณุชุซูุฑ - ุงููุฑุญูุฉ 2๏ธโฃ ููุชููุฉ

## ๐ ุชุงุฑูุฎ ุงูุฅูุฌุงุฒ: 28 ููุงูุฑ 2026

## โ ุงูุญุงูุฉ: ุงููุฑุญูุฉ 2๏ธโฃ ููุชููุฉ ุจูุฌุงุญ

---

## ๐ฏ ุงููุฏู ูู ุงููุฑุญูุฉ 2๏ธโฃ

**ุตูุญุฉ ุงูุณุฏุงุฏ ูู ุญุณุงุจ ุงููุณุชุซูุฑ**

ุฅูุดุงุก ุตูุญุฉ ุณุฏุงุฏ ูุงููุฉ ูููุณุชุซูุฑ ูุน ุงูุชุฑููุฒ ุนูู:
- ุนุฑุถ ุงูุญุฌูุฒุงุช ุงูุฌุงูุฒุฉ ููุณุฏุงุฏ (waiting_for_payment)
- ุนุฑุถ ูุณุงุฆู ุงูุณุฏุงุฏ ุงูููุนูุฉ ููุท
- ุงูุชุญููู ุงูุจููู ููุณููุฉ ุฃุณุงุณูุฉ
- ุฑูุน ุฅูุตุงูุงุช ุงูุชุญููู (ุตูุฑุฉ ุฃู PDF)
- ููุงุญุธุงุช ูุงุถุญุฉ ูููุณุชุซูุฑ

---

## ๐ฆ ูุง ุชู ุฅูุฌุงุฒู

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ุฌุฏูู `payment_receipts`

```sql
CREATE TABLE payment_receipts (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  reservation_id UUID NOT NULL REFERENCES reservations(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  payment_method_id UUID NOT NULL REFERENCES payment_methods(id),
  amount DECIMAL(10, 2) NOT NULL,
  receipt_file_path TEXT NOT NULL,
  receipt_file_type TEXT NOT NULL,
  notes TEXT,
  status TEXT DEFAULT 'pending' CHECK (status IN ('pending', 'approved', 'rejected')),
  reviewed_by UUID REFERENCES admins(id),
  review_notes TEXT,
  reviewed_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);
```

**ุงูุญููู ุงูุฑุฆูุณูุฉ:**

| ุงูุญูู | ุงูููุน | ุงููุตู |
|------|------|-------|
| `reservation_id` | UUID | ูุนุฑู ุงูุญุฌุฒ ุงููุฑุชุจุท |
| `user_id` | UUID | ูุนุฑู ุงููุณุชุซูุฑ |
| `payment_method_id` | UUID | ูุนุฑู ูุณููุฉ ุงูุฏูุน |
| `amount` | DECIMAL | ุงููุจูุบ ุงููุฏููุน |
| `receipt_file_path` | TEXT | ูุณุงุฑ ุงูููู ูู Storage |
| `receipt_file_type` | TEXT | ููุน ุงูููู (image/*, pdf) |
| `notes` | TEXT | ููุงุญุธุงุช ุงููุณุชุซูุฑ |
| `status` | TEXT | ุญุงูุฉ ุงูุฅูุตุงู (pending, approved, rejected) |
| `reviewed_by` | UUID | ูุนุฑู ุงููุฑุงุฌุน |
| `review_notes` | TEXT | ููุงุญุธุงุช ุงููุฑุงุฌุนุฉ |
| `reviewed_at` | TIMESTAMPTZ | ุชุงุฑูุฎ ุงููุฑุงุฌุนุฉ |

**ุงูููุงุฑุณ (Indexes):**
```sql
- idx_payment_receipts_reservation_id
- idx_payment_receipts_user_id
- idx_payment_receipts_status
- idx_payment_receipts_created_at
```

**RLS Policies:**
- โ ุงููุณุชุซูุฑ: ุฑูุน ูุฑุคูุฉ ุฅูุตุงูุงุชู ููุท
- โ ุงููุณุชุซูุฑ: ุชุญุฏูุซ ุงูุฅูุตุงูุงุช ูุจู ุงููุฑุงุฌุนุฉ ููุท
- โ ุงููุฏูุฑ ุงููุงูู ูุงููุฏูุฑ ุงูุนุงู: ุฑุคูุฉ ููุฑุงุฌุนุฉ ุฌููุน ุงูุฅูุตุงูุงุช

**Triggers:**
- โ ุชุญุฏูุซ `updated_at` ุชููุงุฆูุงู
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุฏูุน ูุงูุญุฌุฒ ุนูุฏ ุงูููุงููุฉ ุนูู ุงูุฅูุตุงู

#### Storage Bucket `payment-receipts`

```sql
INSERT INTO storage.buckets (
  id,
  name,
  public,
  file_size_limit,
  allowed_mime_types
) VALUES (
  'payment-receipts',
  'payment-receipts',
  false,
  5242880,  -- 5MB
  ARRAY[
    'image/jpeg',
    'image/jpg',
    'image/png',
    'image/webp',
    'application/pdf'
  ]
);
```

**ุงูุฅุนุฏุงุฏุงุช:**
- ุนุงู: ูุง (private)
- ุงูุญุฏ ุงูุฃูุตู ููููู: 5MB
- ุฃููุงุน ุงููููุงุช: ุตูุฑ (JPEG, PNG, WebP) ู PDF

**Storage Policies:**
- โ ุงููุณุชุซูุฑ: ุฑูุน ูููุงุชู ูู ูุฌูุฏ ุฎุงุต ุจู
- โ ุงููุณุชุซูุฑ: ุฑุคูุฉ ูุญุฐู ูููุงุชู ููุท
- โ ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ: ุฑุคูุฉ ุฌููุน ุงููููุงุช

### 2. ุงูุฎุฏูุฉ (Service)

**ุงูุชุญุฏูุซุงุช ุนูู:** `src/services/paymentService.ts`

#### ุฃ. ุงูุฃููุงุน ุงูุฌุฏูุฏุฉ (Types)

```typescript
export interface PaymentReceipt {
  id: string;
  reservation_id: string;
  user_id: string;
  payment_method_id: string;
  amount: number;
  receipt_file_path: string;
  receipt_file_type: string;
  notes?: string;
  status: 'pending' | 'approved' | 'rejected';
  reviewed_by?: string;
  review_notes?: string;
  reviewed_at?: string;
  created_at: string;
  updated_at: string;
}

export interface UploadReceiptData {
  reservation_id: string;
  payment_method_id: string;
  amount: number;
  file: File;
  notes?: string;
}
```

#### ุจ. ุงููุธุงุฆู ุงูุฌุฏูุฏุฉ

**ุฑูุน ุฅูุตุงู:**
```typescript
await paymentService.uploadReceipt({
  reservation_id: 'uuid',
  payment_method_id: 'uuid',
  amount: 10000,
  file: fileObject,
  notes: 'ููุงุญุธุงุช ุงุฎุชูุงุฑูุฉ'
});
```

**ุงูุญุตูู ุนูู ุฅูุตุงูุงุช ุญุฌุฒ:**
```typescript
const receipts = await paymentService.getReceiptsByReservation(reservationId);
```

**ุงูุญุตูู ุนูู ุฅูุตุงู ูุญุฏุฏ:**
```typescript
const receipt = await paymentService.getReceiptById(receiptId);
```

**ุงูุญุตูู ุนูู ุฑุงุจุท ุงูููู:**
```typescript
const url = await paymentService.getReceiptFileUrl(filePath);
```

**ุญุฐู ุฅูุตุงู:**
```typescript
await paymentService.deleteReceipt(receiptId);
```

**ูุฑุงุฌุนุฉ ุฅูุตุงู (ููุฅุฏุงุฑุฉ):**
```typescript
await paymentService.reviewReceipt(
  receiptId,
  'approved',
  'ุชู ุงูุชุญูู ูู ุงูุชุญููู'
);
```

**ุงููููุฒุงุช:**
- โ ุฑูุน ุชููุงุฆู ููููู ุนูู Storage
- โ ุงูุชุญูู ูู ููุน ูุญุฌู ุงูููู
- โ ุญุฐู ุงูููู ุฅุฐุง ูุดู ุญูุธ ุงูุจูุงูุงุช
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ

### 3. ุตูุญุฉ ุงูุณุฏุงุฏ (UI Component)

**ุงูููู ุงูุฌุฏูุฏ:** `src/components/PaymentPage.tsx`

#### ุฃ. ุงูููููุงุช ุงูุฑุฆูุณูุฉ

**1. ููุฎุต ุงูุญุฌุฒ**
```tsx
<div className="bg-gray-50 rounded-xl p-6">
  <h3>ููุฎุต ุงูุญุฌุฒ</h3>
  - ุงููุฒุฑุนุฉ
  - ุนุฏุฏ ุงูุฃุดุฌุงุฑ
  - ูุฏุฉ ุงูุนูุฏ
  - ุงููุจูุบ ุงููุณุชุญู (ุจุงุฑุฒ ููุจูุฑ)
</div>
```

**2. ุชูุจูู ููู**
```tsx
<div className="bg-blue-50 rounded-xl p-6 border border-blue-100">
  โ๏ธ ูู ูุชู ุชุฃููุฏ ุญุฌุฒู ุฅูุง ุจุนุฏ ุฅุชูุงู ุงูุณุฏุงุฏ ูุงูููุงููุฉ ุนููู
</div>
```

**3. ุงูุฅูุตุงูุงุช ุงููุฑููุนุฉ**
```tsx
{existingReceipts.length > 0 && (
  <div className="bg-amber-50">
    - ุนุฑุถ ุฌููุน ุงูุฅูุตุงูุงุช ุงููุฑููุนุฉ
    - ุญุงูุฉ ูู ุฅูุตุงู (ููุฏ ุงููุฑุงุฌุนุฉุ ููุงููุ ูุฑููุถ)
    - ุชุงุฑูุฎ ุงูุฑูุน
  </div>
)}
```

**4. ูุณุงุฆู ุงูุณุฏุงุฏ ุงููุชุงุญุฉ**
```tsx
<div className="grid grid-cols-2 gap-4">
  {availableMethods.map(method => (
    <button>
      - ุงูุฃููููุฉ
      - ุงูุงุณู
      - ุงููุตู
      - ุนูุงูุฉ ุงูุงุฎุชูุงุฑ โ
    </button>
  ))}
</div>
```

**5. ูุนูููุงุช ุงูุชุญููู ุงูุจููู**
```tsx
{selectedMethod?.method_type === 'bank_transfer' && (
  <div className="bg-blue-50">
    - ุงุณู ุงูุจูู
    - ุฑูู ุงูุขูุจุงู (IBAN)
    - ุงุณู ุงููุณุชููุฏ
    - ุฑูู ุงูุญุณุงุจ
    - ุชุนูููุงุช ููุตูุฉ
  </div>
)}
```

**6. ุฑูุน ุงูุฅูุตุงู**
```tsx
<div>
  - ููุทูุฉ ุณุญุจ ูุฅููุงุช
  - ุฏุนู ุงูุตูุฑ ูุงูู PDF
  - ุญุฏ ุฃูุตู 5MB
  - ููุงุญุธุงุช ุงุฎุชูุงุฑูุฉ
</div>
```

#### ุจ. ุงูุญุงูุงุช (States)

**ุงูุญุงูุงุช ุงููุฏุนููุฉ:**
- โ ุชุญููู (Loading)
- โ ูุง ุชูุฌุฏ ูุณุงุฆู ุณุฏุงุฏ
- โ ุงุฎุชูุงุฑ ูุณููุฉ ุงูุณุฏุงุฏ
- โ ุฑูุน ุงูุฅูุตุงู
- โ ูุฌุงุญ ุงูุฑูุน
- โ ุฃุฎุทุงุก ูุงุถุญุฉ

#### ุฌ. ุงูุชุญูู (Validation)

**ุงูุชุญูู ูู ุงูููู:**
```typescript
- ุญุฌู ุงูููู: ุฃูู ูู 5MB
- ููุน ุงูููู: ุตูุฑุฉ ุฃู PDF
- ูุฌูุฏ ุงูููู ูุจู ุงูุฑูุน
```

**ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช:**
```typescript
- ูุฌูุฏ ุจูุงูุงุช ุงูุชุญููู ุงูุจููู
- ุนุฏู ุฅุธูุงุฑ ุงููุณุงุฆู ุบูุฑ ุงูููุชููุฉ
```

#### ุฏ. ุงูุชุตููู

**ุงูุฃููุงู:**
- ุฃุฎุถุฑ: ุงูุฃุฒุฑุงุฑ ุงูุฃุณุงุณูุฉ
- ุฃุฒุฑู: ุงููุนูููุงุช ูุงูุฅุฑุดุงุฏุงุช
- ุนูุจุฑู: ุงูุชุญุฐูุฑุงุช ูุงูุฅูุตุงูุงุช
- ุฑูุงุฏู: ุงูุฃุฒุฑุงุฑ ุงูุซุงูููุฉ

**ุงูุชูุงุนู:**
- โ Hover effects
- โ Loading states
- โ Success animations
- โ Error messages
- โ Disabled states

### 4. ุงูุชูุงูู ูุน MyReservations

**ุงูุชุญุฏูุซุงุช ุนูู:** `src/components/MyReservations.tsx`

#### ุฃ. States ุงูุฌุฏูุฏุฉ

```typescript
const [showPaymentPage, setShowPaymentPage] = useState(false);
const [selectedReservation, setSelectedReservation] = useState<Reservation | null>(null);
```

#### ุจ. ุฒุฑ ุงูุณุฏุงุฏ ุงูุฌุฏูุฏ

**ูุจู:**
```tsx
{reservation.status === 'waiting_for_payment' && (
  <div>
    <button>ูุฏู</button>
    <button disabled>ุชุงุจู / ุชูุงุฑุง</button>
  </div>
)}
```

**ุจุนุฏ:**
```tsx
{reservation.status === 'waiting_for_payment' && (
  <button onClick={() => {
    setSelectedReservation(reservation);
    setShowPaymentPage(true);
  }}>
    ๐ณ ุฅุชูุงู ุงูุณุฏุงุฏ
  </button>
)}
```

#### ุฌ. ุนุฑุถ ุตูุญุฉ ุงูุณุฏุงุฏ

```tsx
{showPaymentPage && selectedReservation && (
  <PaymentPage
    reservation={{
      id: selectedReservation.id,
      farm_name: selectedReservation.farm_name,
      tree_count: selectedReservation.total_trees,
      contract_years: selectedReservation.duration_years,
      total_amount: selectedReservation.total_price,
      status: selectedReservation.status
    }}
    onClose={() => {
      setShowPaymentPage(false);
      setSelectedReservation(null);
    }}
    onSuccess={() => {
      setShowPaymentPage(false);
      setSelectedReservation(null);
      loadReservations();
    }}
  />
)}
```

---

## ๐ ุชุฏูู ุงูุนูู ุงููุงูู

### ูู ุฌุงูุจ ุงููุณุชุซูุฑ:

```
1. ุงููุณุชุซูุฑ ููุชุญ "ุญุฌูุฒุงุชู"
   โ
2. ูุฑู ุญุฌุฒุงู ุจุญุงูุฉ "ุจุงูุชุธุงุฑ ุงูุณุฏุงุฏ"
   โ
3. ูุถุบุท "ุฅุชูุงู ุงูุณุฏุงุฏ"
   โ
4. ุชูุชุญ ุตูุญุฉ ุงูุณุฏุงุฏ ูุน:
   - ููุฎุต ุงูุญุฌุฒ
   - ุชูุจูู ููู
   - ูุณุงุฆู ุงูุณุฏุงุฏ ุงูููุนูุฉ
   โ
5. ูุฎุชุงุฑ "ุงูุชุญููู ุงูุจููู"
   โ
6. ูุฑู ูุนูููุงุช ุงูุญุณุงุจ ุงูุจููู:
   - ุงุณู ุงูุจูู
   - ุฑูู ุงูุขูุจุงู
   - ุงุณู ุงููุณุชููุฏ
   - ุฑูู ุงูุญุณุงุจ
   โ
7. ูุฐูุจ ููุจูู ููุญูู ุงููุจูุบ
   โ
8. ูุนูุฏ ููุฑูุน ุฅูุตุงู ุงูุชุญููู:
   - ุตูุฑุฉ ูู ุงูุชุทุจูู ุฃู
   - PDF ูู ุงูุจูู
   - ููุงุญุธุงุช ุงุฎุชูุงุฑูุฉ
   โ
9. ูุถุบุท "ุฑูุน ุงูุฅูุตุงู"
   โ
10. โ ูุฑู ุฑุณุงูุฉ ุงููุฌุงุญ:
    "ุชู ุฑูุน ุงูุฅูุตุงู ุจูุฌุงุญ!
     ุณูุชู ูุฑุงุฌุนุชู ุฎูุงู 24 ุณุงุนุฉ"
   โ
11. ููุบูู ุตูุญุฉ ุงูุณุฏุงุฏ ุชููุงุฆูุงู
   โ
12. ูุนูุฏ ุฅูู "ุญุฌูุฒุงุชู"
   โ
13. ูุฑู ุงูุฅูุตุงู ุงููุฑููุน ูุน ุญุงูุฉ "ููุฏ ุงููุฑุงุฌุนุฉ"
```

### ูู ุฌุงูุจ ุงูุฅุฏุงุฑุฉ (ุงููุฑุญูุฉ ุงููุงุฏูุฉ):

```
1. ุงููุฏูุฑ ุงููุงูู ููุชุญ ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ
   โ
2. ูุฑู ูุงุฆูุฉ ุงูุฅูุตุงูุงุช ููุฏ ุงููุฑุงุฌุนุฉ
   โ
3. ููุชุญ ุงูุฅูุตุงู:
   - ูุนูููุงุช ุงูุญุฌุฒ
   - ุตูุฑุฉ ุงูุฅูุตุงู
   - ููุงุญุธุงุช ุงููุณุชุซูุฑ
   โ
4. ูุฑุงุฌุน ุงูุชุญููู ูู ุงูุจูู
   โ
5. ูุถุบุท "ููุงููุฉ" ุฃู "ุฑูุถ"
   โ
6. ุฅุฐุง "ููุงููุฉ":
   โ ุญุงูุฉ ุงูุฅูุตุงู โ approved
   โ ุญุงูุฉ ุงูุฏูุน โ completed
   โ ุญุงูุฉ ุงูุญุฌุฒ โ paid
   โ ุฅุดุนุงุฑ ูููุณุชุซูุฑ
   โ
7. ุฅุฐุง "ุฑูุถ":
   โ ุญุงูุฉ ุงูุฅูุตุงู โ rejected
   โ ุณุจุจ ุงูุฑูุถ
   โ ุฅุดุนุงุฑ ูููุณุชุซูุฑ
   โ ูููู ูููุณุชุซูุฑ ุฑูุน ุฅูุตุงู ุฌุฏูุฏ
```

---

## ๐ ุงูุฃูุงู ูุงูุญูุงูุฉ

### 1. RLS Policies

**ูุฌุฏูู payment_receipts:**

```sql
-- ุงููุณุชุซูุฑ ูุฑูุน ุฅูุตุงูู
CREATE POLICY "Users can upload their own receipts"
  ON payment_receipts FOR INSERT
  TO authenticated
  WITH CHECK (auth.uid() = user_id);

-- ุงููุณุชุซูุฑ ูุฑู ุฅูุตุงูุงุชู ููุท
CREATE POLICY "Users can view their own receipts"
  ON payment_receipts FOR SELECT
  TO authenticated
  USING (auth.uid() = user_id);

-- ุงููุณุชุซูุฑ ูุนุฏู ุงูุฅูุตุงูุงุช ูุจู ุงููุฑุงุฌุนุฉ ููุท
CREATE POLICY "Users can update their pending receipts"
  ON payment_receipts FOR UPDATE
  TO authenticated
  USING (auth.uid() = user_id AND status = 'pending')
  WITH CHECK (auth.uid() = user_id AND status = 'pending');

-- ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ ุชุฑู ูู ุดูุก
CREATE POLICY "Financial managers can view all receipts"
  ON payment_receipts FOR SELECT
  TO authenticated
  USING (
    EXISTS (
      SELECT 1 FROM admins
      WHERE admins.user_id = auth.uid()
      AND admins.role IN ('super_admin', 'financial_manager')
      AND admins.is_active = true
    )
  );
```

**ููู Storage:**

```sql
-- ุงููุณุชุซูุฑ ูุฑูุน ูู ูุฌูุฏู ููุท
CREATE POLICY "Users can upload their own receipts"
  ON storage.objects FOR INSERT
  TO authenticated
  WITH CHECK (
    bucket_id = 'payment-receipts' AND
    (storage.foldername(name))[1] = auth.uid()::text
  );

-- ุงููุณุชุซูุฑ ูุฑู ูููุงุชู ููุท
CREATE POLICY "Users can view their own receipts"
  ON storage.objects FOR SELECT
  TO authenticated
  USING (
    bucket_id = 'payment-receipts' AND
    (storage.foldername(name))[1] = auth.uid()::text
  );
```

### 2. ุงูุชุญูู ูู ุงููููุงุช

**ูู ุงูููุฏ:**
```typescript
// ุญุฌู ุงูููู
if (file.size > 5 * 1024 * 1024) {
  setError('ุญุฌู ุงูููู ูุฌุจ ุฃู ูููู ุฃูู ูู 5 ููุฌุงุจุงูุช');
  return;
}

// ููุน ุงูููู
const allowedTypes = [
  'image/jpeg',
  'image/jpg',
  'image/png',
  'image/webp',
  'application/pdf'
];
if (!allowedTypes.includes(file.type)) {
  setError('ููุน ุงูููู ุบูุฑ ูุฏุนูู');
  return;
}
```

**ูู ุงููุงุนุฏุฉ:**
```sql
INSERT INTO storage.buckets (
  ...
  file_size_limit: 5242880,
  allowed_mime_types: ARRAY[...]
);
```

### 3. ููุน ุงูุชูุงุนุจ

- โ ูุง ูููู ูููุณุชุซูุฑ ุฑุคูุฉ ุฅูุตุงูุงุช ุงูุขุฎุฑูู
- โ ูุง ูููู ูููุณุชุซูุฑ ุชุนุฏูู ุงูุฅูุตุงู ุจุนุฏ ุงููุฑุงุฌุนุฉ
- โ ูุง ูููู ูููุณุชุซูุฑ ุงููุตูู ููููุงุช ุงูุขุฎุฑูู
- โ ุญุฐู ุงูููู ุฅุฐุง ูุดู ุญูุธ ุงูุจูุงูุงุช
- โ ูุนุงููุงุช ุขููุฉ (Transaction-safe)

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ูุง ุชู ุฅูุดุงุคู:

- **ุฌุฏุงูู:** 1 (payment_receipts)
- **Storage Buckets:** 1 (payment-receipts)
- **Policies:** 9 (4 ููุฌุฏูู + 5 ููู Storage)
- **Triggers:** 2 (updated_at + status update)
- **Functions:** 2 (update triggers)
- **Indexes:** 4
- **Service Functions:** 7 (upload, get, delete, review, etc.)
- **UI Components:** 1 (PaymentPage)
- **Lines of Code:** ~600

### ูููุงุช ุชู ุฅูุดุงุคูุง/ุชุนุฏูููุง:

**ูููุงุช ุฌุฏูุฏุฉ:**
1. `supabase/migrations/..._create_payment_receipts_system_v2.sql`
2. `supabase/migrations/..._create_payment_receipts_storage.sql`
3. `src/components/PaymentPage.tsx`

**ูููุงุช ูุญุฏุซุฉ:**
1. `src/services/paymentService.ts` - ุฅุถุงูุฉ ูุธุงุฆู ุงูุฅูุตุงูุงุช
2. `src/components/MyReservations.tsx` - ุฑุจุท ุตูุญุฉ ุงูุณุฏุงุฏ

---

## ๐จ ููุทุงุช ุงูุดุงุดุฉ (ูุตู ูุฑุฆู)

### 1. ุตูุญุฉ ุงูุณุฏุงุฏ - ุงูุฑุฃุณ
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ณ ุฅุชูุงู ุงูุณุฏุงุฏ                  โ โ
โ  ุงุฎุชุฑ ูุณููุฉ ุงูุฏูุน ูุฃููู ุงูุนูููุฉ     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 2. ุงูุชูุจูู ุงูููู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ ููุงุญุธุฉ ูููุฉ:                      โ
โ                                      โ
โ ูู ูุชู ุชุฃููุฏ ุญุฌุฒู ุฅูุง ุจุนุฏ ุฅุชูุงู     โ
โ ุงูุณุฏุงุฏ ูุงูููุงููุฉ ุนููู ูู ูุจู        โ
โ ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ.                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 3. ููุฎุต ุงูุญุฌุฒ
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ููุฎุต ุงูุญุฌุฒ                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงููุฒุฑุนุฉ:        ูุฒุฑุนุฉ ุงูุฒูุชูู ุงูุฐูุจูโ
โ ุนุฏุฏ ุงูุฃุดุฌุงุฑ:               50 ุดุฌุฑุฉ โ
โ ูุฏุฉ ุงูุนูุฏ:                  5 ุณููุงุชโ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงููุจูุบ ุงููุณุชุญู:       ูกู,ููู ุฑ.ุณ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 4. ูุณุงุฆู ุงูุณุฏุงุฏ
```
โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ
โ ๐ณ ูุฏู    โโ  โ ๐ ุชุงุจู     โ
โ ุฏูุน ููุฑู   โ  โ ูุณูู ุนูู 4  โ
โ ูุขูู        โ  โ ุฏูุนุงุช       โ
โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ
โ ๐ ุชูุงุฑุง    โ  โ ๐ฆ ุชุญููู   โ
โ ุงุฏูุน ูุงุญูุงู โ  โ ุจููู        โ
โ             โ  โ             โ
โโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโ
```

### 5. ูุนูููุงุช ุงูุชุญููู ุงูุจููู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ูุนูููุงุช ุงูุชุญููู ุงูุจููู              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงุณู ุงูุจูู                           โ
โ ุงูุจูู ุงูุฃููู ุงูุชุฌุงุฑู                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุฑูู ุงูุขูุจุงู (IBAN)                  โ
โ SA12 3456 7890 1234 5678 9012       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงุณู ุงููุณุชููุฏ                        โ
โ ุดุฑูุฉ ุงููุฒุงุฑุน ุงูุฎุถุฑุงุก                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุฑูู ุงูุญุณุงุจ                          โ
โ 1234567890                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 6. ุฑูุน ุงูุฅูุตุงู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุฑูุน ุฅูุตุงู ุงูุชุญููู *                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                      โ
โ        โฌ ุงุถุบุท ูุงุฎุชูุงุฑ ุงูููู         โ
โ                                      โ
โ     ุตูุฑุฉ ุฃู PDF (ุญุชู 5 ููุฌุงุจุงูุช)   โ
โ                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ููุงุญุธุงุช (ุงุฎุชูุงุฑู)                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุฃู ูุนูููุงุช ุฅุถุงููุฉ ุชูุฏ ุฅุถุงูุชูุง...   โ
โ                                      โ
โ                                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

       [ ุฅูุบุงุก ]  [ โฌ ุฑูุน ุงูุฅูุตุงู ]
```

---

## โ ูุงุชุฌ ุงููุฑุญูุฉ 2๏ธโฃ

### ูุง ุชุญูู:

- โ **ูุณุชุซูุฑ ูุนุฑู ูุงุฐุง ููุนู**
  - ูุนูููุงุช ูุงุถุญุฉ ุนู ุงูุญุฌุฒ
  - ุชุนูููุงุช ููุตูุฉ ููุชุญููู
  - ุฎุทูุงุช ูุงุถุญุฉ ููุณุฏุงุฏ

- โ **ุฅุฏุงุฑุฉ ุชุณุชูุจู ุฅูุตุงูุงุช**
  - ุฌููุน ุงูุฅูุตุงูุงุช ูุญููุธุฉ ุจุฃูุงู
  - ูุนูููุงุช ูุงููุฉ ุนู ูู ุฅูุตุงู
  - ุฌุงูุฒ ูููุฑุงุฌุนุฉ ูุงูููุงููุฉ

- โ **ูุง ุจูุงุจุฉ ุฏูุน ุจุนุฏ**
  - ุงูุชุฑููุฒ ุนูู ุงูุชุญููู ุงูุจููู
  - ุงููุณุงุฆู ุงูุฃุฎุฑู ุชุธูุฑ "ูุฑูุจุงู"
  - ุจููุฉ ุฌุงูุฒุฉ ููุฑุจุท ุงููุณุชูุจูู

---

## ๐ซ ูุง ูู ูุชู ุชูููุฐู (ุญุณุจ ุงูุชุตููู)

### ูู ูุฐู ุงููุฑุญูุฉ:

- โ **ูุง ุฑุจุท ูุนูู ุจูุฏู/ุชุงุจู/ุชูุงุฑุง**
- โ **ูุง ูุฑุงุฌุนุฉ ุชููุงุฆูุฉ ููุฅูุตุงูุงุช**
- โ **ูุง ุฅุดุนุงุฑุงุช ูููุณุชุซูุฑ**
- โ **ูุง ูุงุฌูุฉ ูุฑุงุฌุนุฉ ููุฅุฏุงุฑุฉ ุงููุงููุฉ**

**ุงูุณุจุจ:** ูุฐู ุงููุฑุญูุฉ ููุชุญููู ุงูุจููู ููุท. ุงููุฑุงุฌุนุฉ ูุงูุฑุจุท ุจุงูุจูุงุจุงุช ูู ุงููุฑุงุญู ุงููุงุฏูุฉ.

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุณููุงุฑูู ุงูุงุฎุชุจุงุฑ:

#### 1. ุงููุณุชุซูุฑ ููุชุญ ุญุฌูุฒุงุชู
```
โ ูุฑู ุญุฌุฒุงู ุจุญุงูุฉ "ุจุงูุชุธุงุฑ ุงูุณุฏุงุฏ"
โ ูุฑู ุฒุฑ "ุฅุชูุงู ุงูุณุฏุงุฏ"
```

#### 2. ุงููุณุชุซูุฑ ูุถุบุท ุฅุชูุงู ุงูุณุฏุงุฏ
```
โ ุชูุชุญ ุตูุญุฉ ุงูุณุฏุงุฏ
โ ูุฑู ููุฎุต ุงูุญุฌุฒ
โ ูุฑู ุงูุชูุจูู ุงูููู
โ ูุฑู ูุณุงุฆู ุงูุณุฏุงุฏ ุงูููุนูุฉ
```

#### 3. ุงููุณุชุซูุฑ ูุฎุชุงุฑ ุงูุชุญููู ุงูุจููู
```
โ ูุฑู ูุนูููุงุช ุงูุญุณุงุจ ุงูุจููู
โ ูุฑู ุงูุชุนูููุงุช ุงููุงุถุญุฉ
โ ูุฑู ููุทูุฉ ุฑูุน ุงูุฅูุตุงู
```

#### 4. ุงููุณุชุซูุฑ ูุฎุชุงุฑ ููู
```
โ ูุนูู ูุน ุงูุตูุฑ
โ ูุนูู ูุน PDF
โ ูุฑูุถ ูููุงุช ุฃูุจุฑ ูู 5MB
โ ูุฑูุถ ุฃููุงุน ุบูุฑ ูุฏุนููุฉ
```

#### 5. ุงููุณุชุซูุฑ ูุฑูุน ุงูุฅูุตุงู
```
โ ูุชู ุงูุฑูุน ุจูุฌุงุญ
โ ูุฑู ุฑุณุงูุฉ ุงููุฌุงุญ
โ ุชูุบูู ุงูุตูุญุฉ ุชููุงุฆูุงู
โ ูุฑู ุงูุฅูุตุงู ูู ูุงุฆูุฉ ุงูุฅูุตุงูุงุช
```

### ุงุฎุชุจุงุฑ ุงูุจูุงุก:

```bash
npm run build
```

**ุงููุชูุฌุฉ:** โ ุงูุจูุงุก ูุฌุญ ุจุฏูู ุฃุฎุทุงุก

```
โ 1626 modules transformed
โ built in 9.01s
```

---

## ๐ ุฏููู ุงูุงุณุชุฎุฏุงู

### ูููุณุชุซูุฑ:

#### ุฎุทูุงุช ุงูุณุฏุงุฏ:

1. **ุงูุชุญ ุญุฌูุฒุงุชู**
   ```
   ูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ โ ุญุฌูุฒุงุชู
   ```

2. **ุงุจุญุซ ุนู ุงูุญุฌุฒ**
   ```
   ุงูุญุฌุฒ ุจุญุงูุฉ: "ุจุงูุชุธุงุฑ ุงูุณุฏุงุฏ" ๐ต
   ```

3. **ุงุถุบุท ุฅุชูุงู ุงูุณุฏุงุฏ**
   ```
   ุงูุฒุฑ ุงูุฃุฎุถุฑ ุงููุจูุฑ ๐ณ
   ```

4. **ุงุฎุชุฑ ุงูุชุญููู ุงูุจููู**
   ```
   ุงููุณููุฉ ุงููุญูุฏุฉ ุงููุชุงุญุฉ ุญุงููุงู ๐ฆ
   ```

5. **ุงูุณุฎ ูุนูููุงุช ุงูุญุณุงุจ**
   ```
   - ุงุณู ุงูุจูู
   - ุฑูู ุงูุขูุจุงู
   - ุงุณู ุงููุณุชููุฏ
   - ุฑูู ุงูุญุณุงุจ
   ```

6. **ุงุฐูุจ ููุจูู**
   ```
   ุนุจุฑ ุงูุชุทุจูู ุฃู ุงููุฑุน
   ```

7. **ุญููู ุงููุจูุบ ุจุงูุถุจุท**
   ```
   ุงููุจูุบ ุงููุทููุจ: ูกู,ููู ุฑ.ุณ
   ```

8. **ุงุญุตู ุนูู ุงูุฅูุตุงู**
   ```
   ุตูุฑุฉ ูู ุงูุชุทุจูู ุฃู PDF ูู ุงูุจูู
   ```

9. **ุงุฑุฌุน ูููููุน**
   ```
   ููุณ ุตูุญุฉ ุงูุณุฏุงุฏ
   ```

10. **ุงุฑูุน ุงูุฅูุตุงู**
    ```
    ุงุถุบุท ููุทูุฉ ุงูุฑูุน โ ุงุฎุชุฑ ุงูููู
    ```

11. **ุฃุถู ููุงุญุธุงุช (ุงุฎุชูุงุฑู)**
    ```
    ูุซุงู: "ุชู ุงูุชุญููู ูู ุญุณุงุจ ุดุฎุตู"
    ```

12. **ุงุถุบุท ุฑูุน**
    ```
    ุงูุฒุฑ ุงูุฃุฎุถุฑ โฌ
    ```

13. **ุงูุชุธุฑ ุงููุฑุงุฌุนุฉ**
    ```
    ุณูุชู ุฅุฎุทุงุฑู ุฎูุงู 24 ุณุงุนุฉ
    ```

### ููุฅุฏุงุฑุฉ (ูุฑูุจุงู):

ุณุชุชููุฑ ูุงุฌูุฉ ูุฑุงุฌุนุฉ ุงูุฅูุตุงูุงุช ูู ุงููุฑุญูุฉ ุงููุงุฏูุฉ.

---

## ๐ฏ ุงูุฌุงูุฒูุฉ ูููุฑุงุญู ุงููุงุฏูุฉ

### ุงููุฑุญูุฉ 3๏ธโฃ: ูุฑุงุฌุนุฉ ุงูุฅูุตุงูุงุช (ุฌุงูุฒ)

ุงูุจููุฉ ุงูุชุญุชูุฉ ุฌุงูุฒุฉ ูู:
- โ ูุงุฌูุฉ ูุฑุงุฌุนุฉ ููุฅุฏุงุฑุฉ ุงููุงููุฉ
- โ ุนุฑุถ ุงูุฅูุตุงูุงุช ููุฏ ุงููุฑุงุฌุนุฉ
- โ ูุชุญ ูุนุฑุถ ุงูุฅูุตุงู
- โ ุงูููุงููุฉ ุฃู ุงูุฑูุถ
- โ ุชุญุฏูุซ ุงูุญุงูุงุช ุชููุงุฆูุงู

### ุงููุฑุญูุฉ 4๏ธโฃ: ุฑุจุท ุงูุจูุงุจุงุช (ุฌุงูุฒ)

ุงููุธุงู ุฌุงูุฒ ูู:
- โ ุฑุจุท ูุฏู (Moyasar/HyperPay)
- โ ุฑุจุท ุชุงุจู
- โ ุฑุจุท ุชูุงุฑุง
- โ ูุนุงูุฌุฉ Webhooks
- โ ุชุญุฏูุซ ุงูุญุงูุงุช ุชููุงุฆูุงู

### ุงููุฑุญูุฉ 5๏ธโฃ: ุงูุฅุดุนุงุฑุงุช (ุฌุงูุฒ)

ุงููุธุงู ุฌุงูุฒ ูู:
- โ ุฅุดุนุงุฑ ุนูุฏ ุฑูุน ุงูุฅูุตุงู
- โ ุฅุดุนุงุฑ ุนูุฏ ุงููุฑุงุฌุนุฉ
- โ ุฅุดุนุงุฑ ุนูุฏ ุงูููุงููุฉ/ุงูุฑูุถ
- โ ุฅุดุนุงุฑ ุนูุฏ ุงูุชูุงู ุงูุฏูุน

---

## ๐ ุงูุฑุจุท ุงูุขูู

### Triggers ุงูุฐููุฉ:

**ุนูุฏ ุงูููุงููุฉ ุนูู ุฅูุตุงู:**
```sql
CREATE TRIGGER payment_status_on_receipt_approval
  AFTER UPDATE ON payment_receipts
  FOR EACH ROW
  WHEN (NEW.status = 'approved' AND OLD.status != 'approved')
  EXECUTE FUNCTION update_payment_status_on_receipt_approval();
```

**ุงููุชูุฌุฉ:**
```
ุฅูุตุงู: pending โ approved
   โ
ุฏูุน: waiting_for_payment โ completed
   โ
ุญุฌุฒ: waiting_for_payment โ paid
   โ
โ ูู ุดูุก ูุชุญุฏุซ ุชููุงุฆูุงู!
```

---

## ๐ ุงูุฎูุงุตุฉ

### โ ูุง ุชู ุฅูุฌุงุฒู ูู ุงููุฑุญูุฉ 2๏ธโฃ:

1. **ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
   - ุฌุฏูู payment_receipts ูุงูู
   - Storage bucket ููุฅูุตุงูุงุช
   - RLS policies ุขููุฉ
   - Triggers ุฐููุฉ

2. **ุงูุฎุฏูุฉ:**
   - ูุธุงุฆู ุฑูุน ุงูุฅูุตุงูุงุช
   - ูุธุงุฆู ุงููุฑุงุฌุนุฉ (ููุฅุฏุงุฑุฉ)
   - ูุนุงูุฌุฉ ุงููููุงุช
   - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

3. **ุงููุงุฌูุฉ:**
   - ุตูุญุฉ ุณุฏุงุฏ ุงุญุชุฑุงููุฉ
   - ุนุฑุถ ูุงุถุญ ูููุนูููุงุช
   - ุฑูุน ุณูู ููุฅูุตุงูุงุช
   - ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ

4. **ุงูุชูุงูู:**
   - ูุฏูุฌ ูุน MyReservations
   - ูุชุงุญ ูุฌููุน ุงููุณุชุซูุฑูู
   - ูุนูู ููุท ูุน ุงูุญุฌูุฒุงุช ุงููุนุชูุฏุฉ

### โ ูุงุชุฌ ุงููุฑุญูุฉ 2๏ธโฃ:

- **ูุณุชุซูุฑ ูุนุฑู ูุงุฐุง ููุนู** โ
- **ุฅุฏุงุฑุฉ ุชุณุชูุจู ุฅูุตุงูุงุช** โ
- **ูุง ุจูุงุจุฉ ุฏูุน ุจุนุฏ** โ (ุญุณุจ ุงูุชุตููู)

---

## ๐ ุงูุฎุทูุฉ ุงูุชุงููุฉ

**ุฌุงูุฒ ูููุฑุญูุฉ 3๏ธโฃ:** ูุฑุงุฌุนุฉ ุงูุฅูุตุงูุงุช ูู ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ

ุนูุฏ ุงูุงุณุชุนุฏุงุฏุ ูููู ุงูุจุฏุก ูู:
1. ุฅูุดุงุก ูุงุฌูุฉ ูุฑุงุฌุนุฉ ุงูุฅูุตุงูุงุช
2. ุฅุถุงูุฉ ูุณู ูู ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ
3. ูุธุงู ุงูููุงููุฉ/ุงูุฑูุถ
4. ูุธุงู ุงูุฅุดุนุงุฑุงุช

---

**๐ ุชุงุฑูุฎ ุงูุฅููุงู:** 28 ููุงูุฑ 2026

**โ ุงูุญุงูุฉ:** ุงููุฑุญูุฉ 2๏ธโฃ ููุชููุฉ ููุฎุชุจุฑุฉ โ

**๐ฏ ุงููุชูุฌุฉ:** ุตูุญุฉ ุณุฏุงุฏ ูุงููุฉ ููุชูุงููุฉุ ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู ุงูููุฑู!
